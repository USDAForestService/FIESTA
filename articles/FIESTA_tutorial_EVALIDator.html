<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>FIESTA - EVALIDator API - compare • FIESTA</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="FIESTA - EVALIDator API - compare">
<meta name="description" content="Generate estimates from FIESTA using population data from FIADB and compare with estimates from the EVALIDator API.">
<meta property="og:description" content="Generate estimates from FIESTA using population data from FIADB and compare with estimates from the EVALIDator API.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FIESTA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.7.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/FIESTA_tutorial_GB.html">Green-book Estimators</a></li>
    <li><a class="dropdown-item" href="../articles/FIESTA_tutorial_MA.html">Model-Assisted Estimators</a></li>
    <li><a class="dropdown-item" href="../articles/FIESTA_tutorial_SA.html">Small Area Estimators</a></li>
    <li><a class="dropdown-item" href="../articles/FIESTA_tutorial_PB.html">Photo-Based Estimators</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/USDAForestService/FIESTA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>FIESTA - EVALIDator API - compare</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/USDAForestService/FIESTA/blob/master/vignettes/articles/FIESTA_tutorial_EVALIDator.rmd" class="external-link"><code>vignettes/articles/FIESTA_tutorial_EVALIDator.rmd</code></a></small>
      <div class="d-none name"><code>FIESTA_tutorial_EVALIDator.rmd</code></div>
    </div>

    
    
<p>The FIESTA R package is an estimation engine that generates estimates
using FIA data for custom situations (Frescino et al. 2023). The package
provides functions for using FIA’s standard estimation techniques and
also includes different modules for using alternative estimation
strategies for unique situations (Frescino et al. 2022). The package
facilitates compilation of FIA and geospatial auxiliary information
needed for estimation and provides consistent output for reporting.</p>
<p>To use the FIESTA R package, you need to be familiar with the R
statistical software and also have a firm knowledge of the FIA database.
Please consult the FIA database description user guide (Version 9.0.1)
for variable descriptions (Burrill et al. 2021).</p>
<p>The following examples demonstrate how we can use FIA’s standard
estimators through FIESTA to generate estimates that match EVALIDator
(<a href="https://apps.fs.usda.gov/fiadb-api/evalidator" class="external-link uri">https://apps.fs.usda.gov/fiadb-api/evalidator</a>). The
example uses population data that were previously generated and stored
in FIADB. Plot coordinates are not needed for this exercise.</p>
<p>Install necessary packages and set options.</p>
<pre><code><span><span class="co"># devtools::install_github("USDAForestService/FIESTAnalysis")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FIESTAnalysis</span><span class="op">)</span></span></code></pre>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>scipen <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://usdaforestservice.github.io/FIESTA/">FIESTA</a></span><span class="op">)</span></span>
<span><span class="va">outfolder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
<div class="section level2">
<h2 id="get-area-of-interest">Get Area of Interest<a class="anchor" aria-label="anchor" href="#get-area-of-interest"></a>
</h2>
<pre><code><span><span class="va">state</span> <span class="op">&lt;-</span> <span class="st">"Colorado"</span></span>
<span><span class="va">evalyr</span> <span class="op">&lt;-</span> <span class="fl">21</span></span>
<span><span class="va">evalendTypeVOL</span> <span class="op">&lt;-</span> <span class="st">"01"</span></span>
<span><span class="va">evalendTypeCHNG</span> <span class="op">&lt;-</span> <span class="st">"03"</span></span>
<span></span>
<span><span class="va">stabbr</span> <span class="op">&lt;-</span> <span class="va">ref_statecd</span><span class="op">[</span><span class="va">ref_statecd</span><span class="op">$</span><span class="va">MEANING</span> <span class="op">==</span> <span class="va">state</span>, <span class="st">"ABBR"</span><span class="op">]</span></span>
<span><span class="va">stcd</span> <span class="op">&lt;-</span> <span class="va">ref_statecd</span><span class="op">[</span><span class="va">ref_statecd</span><span class="op">$</span><span class="va">MEANING</span> <span class="op">==</span> <span class="va">state</span>, <span class="st">"VALUE"</span><span class="op">]</span></span>
<span><span class="co">#evalid &lt;- paste0(formatC(stcd, width =2, flag="0"), evalyr, evalType)</span></span>
<span><span class="va">evalidVOL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">stcd</span>, <span class="va">evalyr</span>, <span class="va">evalendTypeVOL</span><span class="op">)</span></span>
<span><span class="va">evalidCHNG</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">stcd</span>, <span class="va">evalyr</span>, <span class="va">evalendTypeCHNG</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create folder for population of interest inside outfolder </span></span>
<span><span class="va">popfolder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">outfolder</span>, <span class="va">state</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">popfolder</span><span class="op">)</span></span></code></pre>
<pre><code><span><span class="co">## Set name of output SQLite database and data object</span></span>
<span><span class="va">out_dsn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"pltdat_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">stabbr</span>, collapse<span class="op">=</span><span class="st">""</span><span class="op">)</span>, <span class="st">"_20"</span>, <span class="va">evalyr</span>, <span class="st">".db"</span><span class="op">)</span></span>
<span><span class="va">out_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"pltdat_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">stabbr</span>, collapse<span class="op">=</span><span class="st">""</span><span class="op">)</span>, <span class="st">"_20"</span>, <span class="va">evalyr</span>, <span class="st">".rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Get data from FIA datamart for public only plots, All VOL Evaluations</span></span>
<span><span class="va">pltdat</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/DBgetPlots.html">DBgetPlots</a></span><span class="op">(</span></span>
<span>     datsource <span class="op">=</span> <span class="st">"datamart"</span>,    <span class="co">## Access datamart</span></span>
<span>     states <span class="op">=</span> <span class="va">state</span>,           <span class="co">## States of interest</span></span>
<span>     eval <span class="op">=</span> <span class="st">"FIA"</span>,                     <span class="co">## Get an FIA Evaluation</span></span>
<span>     eval_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>evalid<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">evalidVOL</span>, <span class="va">evalidCHNG</span><span class="op">)</span><span class="op">)</span>,  <span class="co">## Get all annual Evaluations for VOL</span></span>
<span>     isseed <span class="op">=</span> <span class="cn">TRUE</span>,             <span class="co">## Include seedling data</span></span>
<span>     addplotgeom <span class="op">=</span> <span class="cn">TRUE</span>,        <span class="co">## Add plot data from PLOTGEOM table (for ALP_ADFORCD)</span></span>
<span>     issp <span class="op">=</span> <span class="cn">TRUE</span>,               <span class="co">## Make XY coordinates spatial</span></span>
<span>     ischng <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>     returndata <span class="op">=</span> <span class="cn">TRUE</span>,         <span class="co">## Return data as R list object</span></span>
<span>     savePOP <span class="op">=</span> <span class="cn">TRUE</span>,            <span class="co">## Return POP tables (POP_PLOT_STRATUM_ASSGN, POP_STRATUM, POP_ESTN_UNIT)</span></span>
<span>     savedata <span class="op">=</span> <span class="cn">TRUE</span>,           <span class="co">## Save data to an folder</span></span>
<span>     savedata_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>outfolder <span class="op">=</span> <span class="va">popfolder</span>,   <span class="co">## Save data to a SQLite database</span></span>
<span>                          out_dsn <span class="op">=</span> <span class="va">out_dsn</span>,</span>
<span>                          out_fmt <span class="op">=</span> <span class="st">"sqlite"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; downloading and extracting SURVEY for CO ...</span></span>
<span><span class="co">#&gt; downloading and extracting POP_EVAL for CO ...</span></span>
<span><span class="co">#&gt; downloading and extracting POP_EVAL_GRP for CO ...</span></span>
<span><span class="co">#&gt; downloading and extracting POP_EVAL_TYP for CO ...</span></span>
<span><span class="co">#&gt; downloading and extracting PLOT for CO ...</span></span>
<span><span class="co">#&gt; downloading and extracting POP_PLOT_STRATUM_ASSGN for CO ...</span></span>
<span><span class="co">#&gt; issp=TRUE, but getxy = FALSE...  changing getxy = TRUE</span></span>
<span><span class="co">#&gt; creating new SQLite database...</span></span>
<span><span class="co">#&gt; ================================================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; getting data for Colorado...</span></span>
<span><span class="co">#&gt; downloading and extracting PLOT for CO ...</span></span>
<span><span class="co">#&gt; downloading and extracting PLOTGEOM for CO ...</span></span>
<span><span class="co">#&gt; downloading and extracting COND for CO ...</span></span>
<span><span class="co">#&gt; downloading and extracting POP_PLOT_STRATUM_ASSGN for CO ...</span></span>
<span><span class="co">#&gt; downloading and extracting POP_STRATUM for CO ...</span></span>
<span><span class="co">#&gt; downloading and extracting POP_ESTN_UNIT for CO ...</span></span>
<span><span class="co">#&gt; 8 - ppsa.EVALID IN(82101, 82103)</span></span>
<span><span class="co">#&gt; WITH </span></span>
<span><span class="co">#&gt; p AS</span></span>
<span><span class="co">#&gt;  (SELECT distinct p.*</span></span>
<span><span class="co">#&gt; FROM POP_PLOT_STRATUM_ASSGN ppsa </span></span>
<span><span class="co">#&gt; JOIN XYdf p ON (ppsa.PLT_CN = p.CN) </span></span>
<span><span class="co">#&gt;   WHERE EVALID in(82101, 82103))</span></span>
<span><span class="co">#&gt; SELECT xy.CN, xy.LON, xy.LAT, xy.STATECD, xy.UNITCD, xy.COUNTYCD, xy.PLOT, xy.INVYR, xy.PLOT_STATUS_CD, xy.INTENSITY</span></span>
<span><span class="co">#&gt; FROM XYdf xy</span></span>
<span><span class="co">#&gt; INNER JOIN p ON (xy.CN = p.CN)</span></span>
<span></span>
<span><span class="co">## Check datAZNM and pull out XY data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pltdat</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "states"                 "tabs"                   "tabIDs"                </span></span>
<span><span class="co">#&gt;  [4] "dbqueries"              "puniqueid"              "xy_PUBLIC"             </span></span>
<span><span class="co">#&gt;  [7] "pop_plot_stratum_assgn" "pop_stratum"            "pop_estn_unit"         </span></span>
<span><span class="co">#&gt; [10] "evalid"                 "evalEndyr"              "pltcnt"                </span></span>
<span><span class="co">#&gt; [13] "invyrs"                 "evalInfo"               "ref_species"           </span></span>
<span><span class="co">#&gt; [16] "args"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pltdat</span><span class="op">$</span><span class="va">pop_plot_stratum_assgn</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "CN"            "STRATUM_CN"    "PLT_CN"        "STATECD"      </span></span>
<span><span class="co">#&gt;  [5] "INVYR"         "UNITCD"        "COUNTYCD"      "PLOT"         </span></span>
<span><span class="co">#&gt;  [9] "RSCD"          "EVALID"        "ESTN_UNIT"     "STRATUMCD"    </span></span>
<span><span class="co">#&gt; [13] "CREATED_DATE"  "MODIFIED_DATE"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">pltdat</span><span class="op">$</span><span class="va">pop_plot_stratum_assgn</span><span class="op">$</span><span class="va">EVALID</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 82101 82103 </span></span>
<span><span class="co">#&gt; 10814 10588</span></span>
<span></span>
<span><span class="co">## Get public XY coordinates</span></span>
<span><span class="va">xydat</span> <span class="op">&lt;-</span> <span class="va">pltdat</span><span class="op">$</span><span class="va">xy_PUBLIC</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">xydat</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 10814    13</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">xydat</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "PLT_CN"         "STATECD"        "UNITCD"         "COUNTYCD"      </span></span>
<span><span class="co">#&gt;  [5] "PLOT"           "INVYR"          "PLOT_STATUS_CD" "INTENSITY"     </span></span>
<span><span class="co">#&gt;  [9] "PLOT_ID"        "COUNTYFIPS"     "LON_PUBLIC"     "LAT_PUBLIC"    </span></span>
<span><span class="co">#&gt; [13] "geometry"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">xydat</span><span class="op">$</span><span class="va">STATECD</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     8 </span></span>
<span><span class="co">#&gt; 10814</span></span>
<span></span>
<span></span>
<span><span class="co">## Extract the EVALIDATOR_POP_ESTIMATE table from datamart</span></span>
<span><span class="va">fn</span> <span class="op">&lt;-</span> <span class="st">"https://apps.fs.usda.gov/fia/datamart/CSV/EVALIDATOR_POP_ESTIMATE.csv"</span></span>
<span><span class="va">EVALIDATOR_POP_ESTIMATE</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="va">fn</span>, integer64 <span class="op">=</span> <span class="st">"character"</span><span class="op">)</span></span></code></pre>
<p>We can check out the database we created to make sure it has all of
the necessary tables and is properly indexed.</p>
<pre><code><span><span class="co">## Define database</span></span>
<span><span class="va">dbfn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">popfolder</span>, <span class="va">out_dsn</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Open connection of database</span></span>
<span><span class="va">dbconn</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu"><a href="https://rsqlite.r-dbi.org/reference/SQLite.html" class="external-link">SQLite</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">dbfn</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## List tables in database</span></span>
<span><span class="va">tablst</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbListTables.html" class="external-link">dbListTables</a></span><span class="op">(</span><span class="va">dbconn</span><span class="op">)</span></span>
<span><span class="va">tablst</span></span>
<span><span class="co">#&gt;  [1] "cond"                   "condu"                  "plot"                  </span></span>
<span><span class="co">#&gt;  [4] "plotu"                  "pltcnt"                 "pop_estn_unit"         </span></span>
<span><span class="co">#&gt;  [7] "pop_plot_stratum_assgn" "pop_stratum"            "ref_species"           </span></span>
<span><span class="co">#&gt; [10] "seedling"               "subp_cond_chng_mtrx"    "tree"                  </span></span>
<span><span class="co">#&gt; [13] "xy_PUBLIC"</span></span>
<span></span>
<span><span class="co">## List fields in table</span></span>
<span><span class="va">ppsa_flds</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbListFields.html" class="external-link">dbListFields</a></span><span class="op">(</span><span class="va">dbconn</span>, <span class="st">"pop_plot_stratum_assgn"</span><span class="op">)</span></span>
<span><span class="va">ppsa_flds</span></span>
<span><span class="co">#&gt;  [1] "CN"            "STRATUM_CN"    "PLT_CN"        "STATECD"      </span></span>
<span><span class="co">#&gt;  [5] "INVYR"         "UNITCD"        "COUNTYCD"      "PLOT"         </span></span>
<span><span class="co">#&gt;  [9] "RSCD"          "EVALID"        "ESTN_UNIT"     "STRATUMCD"    </span></span>
<span><span class="co">#&gt; [13] "CREATED_DATE"  "MODIFIED_DATE"</span></span>
<span></span>
<span><span class="co">## check indices</span></span>
<span><span class="fu">FIESTAutils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/FIESTAutils/man/internal_desc.html" class="external-link">checkidx</a></span><span class="op">(</span><span class="va">dbconn</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                                       name</span></span>
<span><span class="co">#&gt; 1                                     xy_PUBLIC_plt_cn_idx</span></span>
<span><span class="co">#&gt; 2         xy_PUBLIC_statecd_unitcd_countycd_plot_invyr_idx</span></span>
<span><span class="co">#&gt; 3                                             plotu_cn_idx</span></span>
<span><span class="co">#&gt; 4                                 plotu_cn_prev_plt_cn_idx</span></span>
<span><span class="co">#&gt; 5                   plotu_statecd_unitcd_countycd_plot_idx</span></span>
<span><span class="co">#&gt; 6                                  condu_plt_cn_condid_idx</span></span>
<span><span class="co">#&gt; 7                           subp_cond_chng_mtrx_plt_cn_idx</span></span>
<span><span class="co">#&gt; 8                      subp_cond_chng_mtrx_prev_plt_cn_idx</span></span>
<span><span class="co">#&gt; 9                         tree_plt_cn_condid_subp_tree_idx</span></span>
<span><span class="co">#&gt; 10                                    tree_prev_tre_cn_idx</span></span>
<span><span class="co">#&gt; 11                                             plot_cn_idx</span></span>
<span><span class="co">#&gt; 12             plot_statecd_unitcd_countycd_plot_invyr_idx</span></span>
<span><span class="co">#&gt; 13                                  cond_plt_cn_condid_idx</span></span>
<span><span class="co">#&gt; 14 pop_plot_stratum_assgn_statecd_unitcd_countycd_plot_idx</span></span>
<span><span class="co">#&gt; 15   pop_plot_stratum_assgn_evalid_estn_unit_stratumcd_idx</span></span>
<span><span class="co">#&gt; 16         pop_stratum_rscd_evalid_estn_unit_stratumcd_idx</span></span>
<span><span class="co">#&gt; 17                 pop_estn_unit_rscd_evalid_estn_unit_idx</span></span>
<span><span class="co">#&gt; 18                                    ref_species_spcd_idx</span></span>
<span><span class="co">#&gt; 19                          ref_species_species_symbol_idx</span></span>
<span><span class="co">#&gt;                  tbl_name</span></span>
<span><span class="co">#&gt; 1               xy_PUBLIC</span></span>
<span><span class="co">#&gt; 2               xy_PUBLIC</span></span>
<span><span class="co">#&gt; 3                   plotu</span></span>
<span><span class="co">#&gt; 4                   plotu</span></span>
<span><span class="co">#&gt; 5                   plotu</span></span>
<span><span class="co">#&gt; 6                   condu</span></span>
<span><span class="co">#&gt; 7     subp_cond_chng_mtrx</span></span>
<span><span class="co">#&gt; 8     subp_cond_chng_mtrx</span></span>
<span><span class="co">#&gt; 9                    tree</span></span>
<span><span class="co">#&gt; 10                   tree</span></span>
<span><span class="co">#&gt; 11                   plot</span></span>
<span><span class="co">#&gt; 12                   plot</span></span>
<span><span class="co">#&gt; 13                   cond</span></span>
<span><span class="co">#&gt; 14 pop_plot_stratum_assgn</span></span>
<span><span class="co">#&gt; 15 pop_plot_stratum_assgn</span></span>
<span><span class="co">#&gt; 16            pop_stratum</span></span>
<span><span class="co">#&gt; 17          pop_estn_unit</span></span>
<span><span class="co">#&gt; 18            ref_species</span></span>
<span><span class="co">#&gt; 19            ref_species</span></span>
<span><span class="co">#&gt;                                                                                                                             sql</span></span>
<span><span class="co">#&gt; 1                                                                 CREATE UNIQUE INDEX xy_PUBLIC_plt_cn_idx ON xy_PUBLIC(PLT_CN)</span></span>
<span><span class="co">#&gt; 2         CREATE UNIQUE INDEX xy_PUBLIC_statecd_unitcd_countycd_plot_invyr_idx ON xy_PUBLIC(STATECD,UNITCD,COUNTYCD,PLOT,INVYR)</span></span>
<span><span class="co">#&gt; 3                                                                                 CREATE UNIQUE INDEX plotu_cn_idx ON plotu(CN)</span></span>
<span><span class="co">#&gt; 4                                                         CREATE UNIQUE INDEX plotu_cn_prev_plt_cn_idx ON plotu(CN,PREV_PLT_CN)</span></span>
<span><span class="co">#&gt; 5                                    CREATE INDEX plotu_statecd_unitcd_countycd_plot_idx ON plotu(STATECD,UNITCD,COUNTYCD,PLOT)</span></span>
<span><span class="co">#&gt; 6                                                           CREATE UNIQUE INDEX condu_plt_cn_condid_idx ON condu(PLT_CN,CONDID)</span></span>
<span><span class="co">#&gt; 7                                                    CREATE INDEX subp_cond_chng_mtrx_plt_cn_idx ON subp_cond_chng_mtrx(PLT_CN)</span></span>
<span><span class="co">#&gt; 8                                          CREATE INDEX subp_cond_chng_mtrx_prev_plt_cn_idx ON subp_cond_chng_mtrx(PREV_PLT_CN)</span></span>
<span><span class="co">#&gt; 9                                         CREATE UNIQUE INDEX tree_plt_cn_condid_subp_tree_idx ON tree(PLT_CN,CONDID,SUBP,TREE)</span></span>
<span><span class="co">#&gt; 10                                                                       CREATE INDEX tree_prev_tre_cn_idx ON tree(PREV_TRE_CN)</span></span>
<span><span class="co">#&gt; 11                                                                                  CREATE UNIQUE INDEX plot_cn_idx ON plot(CN)</span></span>
<span><span class="co">#&gt; 12                  CREATE UNIQUE INDEX plot_statecd_unitcd_countycd_plot_invyr_idx ON plot(STATECD,UNITCD,COUNTYCD,PLOT,INVYR)</span></span>
<span><span class="co">#&gt; 13                                                            CREATE UNIQUE INDEX cond_plt_cn_condid_idx ON cond(PLT_CN,CONDID)</span></span>
<span><span class="co">#&gt; 14 CREATE INDEX pop_plot_stratum_assgn_statecd_unitcd_countycd_plot_idx ON pop_plot_stratum_assgn(STATECD,UNITCD,COUNTYCD,PLOT)</span></span>
<span><span class="co">#&gt; 15     CREATE INDEX pop_plot_stratum_assgn_evalid_estn_unit_stratumcd_idx ON pop_plot_stratum_assgn(EVALID,ESTN_UNIT,STRATUMCD)</span></span>
<span><span class="co">#&gt; 16          CREATE UNIQUE INDEX pop_stratum_rscd_evalid_estn_unit_stratumcd_idx ON pop_stratum(RSCD,EVALID,ESTN_UNIT,STRATUMCD)</span></span>
<span><span class="co">#&gt; 17                          CREATE UNIQUE INDEX pop_estn_unit_rscd_evalid_estn_unit_idx ON pop_estn_unit(RSCD,EVALID,ESTN_UNIT)</span></span>
<span><span class="co">#&gt; 18                                                                CREATE UNIQUE INDEX ref_species_spcd_idx ON ref_species(SPCD)</span></span>
<span><span class="co">#&gt; 19                                            CREATE UNIQUE INDEX ref_species_species_symbol_idx ON ref_species(SPECIES_SYMBOL)</span></span>
<span><span class="fu">FIESTAutils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/FIESTAutils/man/internal_desc.html" class="external-link">checkidx</a></span><span class="op">(</span><span class="va">dbconn</span>, <span class="st">"pop_plot_stratum_assgn"</span><span class="op">)</span></span>
<span><span class="co">#&gt; checking indices in database...</span></span>
<span><span class="co">#&gt;                 tbl_name</span></span>
<span><span class="co">#&gt; 1 pop_plot_stratum_assgn</span></span>
<span><span class="co">#&gt; 2 pop_plot_stratum_assgn</span></span>
<span><span class="co">#&gt;                                                                                                                            sql</span></span>
<span><span class="co">#&gt; 1 CREATE INDEX pop_plot_stratum_assgn_statecd_unitcd_countycd_plot_idx ON pop_plot_stratum_assgn(STATECD,UNITCD,COUNTYCD,PLOT)</span></span>
<span><span class="co">#&gt; 2     CREATE INDEX pop_plot_stratum_assgn_evalid_estn_unit_stratumcd_idx ON pop_plot_stratum_assgn(EVALID,ESTN_UNIT,STRATUMCD)</span></span>
<span><span class="co">#&gt;                           cols</span></span>
<span><span class="co">#&gt; 1 STATECD,UNITCD,COUNTYCD,PLOT</span></span>
<span><span class="co">#&gt; 2   EVALID,ESTN_UNIT,STRATUMCD</span></span>
<span></span>
<span></span>
<span><span class="co">## get saved population tables from database</span></span>
<span><span class="va">pop_stratum</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbReadTable.html" class="external-link">dbReadTable</a></span><span class="op">(</span><span class="va">dbconn</span>, <span class="st">"pop_stratum"</span><span class="op">)</span></span>
<span><span class="va">pop_estn_unit</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbReadTable.html" class="external-link">dbReadTable</a></span><span class="op">(</span><span class="va">dbconn</span>, <span class="st">"pop_estn_unit"</span><span class="op">)</span></span>
<span><span class="va">pop_plot_stratum_assgn</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbReadTable.html" class="external-link">dbReadTable</a></span><span class="op">(</span><span class="va">dbconn</span>, <span class="st">"pop_plot_stratum_assgn"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">pop_stratum</span><span class="op">$</span><span class="va">EVALID</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 82101 82103</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">pop_estn_unit</span><span class="op">$</span><span class="va">EVALID</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 82101 82103</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu">uniqu</span><span class="op">(</span><span class="va">pop_plot_stratum_assgn</span><span class="op">$</span><span class="va">EVALID</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 82101 82103</span></span></code></pre>
<p>Next, we use <code>modGBpop</code> to create population data for the
estimates. We can explore the data objects that are returned as well as
the queries that are built.</p>
<pre><code><span><span class="va">popdatVOL</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modGBpop.html">modGBpop</a></span><span class="op">(</span>popType <span class="op">=</span> <span class="st">"VOL"</span>,</span>
<span>                      dbconn <span class="op">=</span> <span class="va">dbconn</span>,</span>
<span>                      popFilter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>evalid <span class="op">=</span> <span class="va">evalidVOL</span><span class="op">)</span>,</span>
<span>                      pltassgn <span class="op">=</span> <span class="st">"pop_plot_stratum_assgn"</span>,</span>
<span>                      unitarea <span class="op">=</span> <span class="st">"pop_estn_unit"</span>,</span>
<span>                      unitvar <span class="op">=</span> <span class="st">"ESTN_UNIT"</span>,</span>
<span>                      unit_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>unitvar2 <span class="op">=</span> <span class="st">"STATECD"</span>, minplotnum.unit <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                      areavar <span class="op">=</span> <span class="st">"AREA_USED"</span>,</span>
<span>                      stratalut <span class="op">=</span> <span class="st">"pop_stratum"</span>,</span>
<span>                      strata <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      strvar <span class="op">=</span> <span class="st">"STRATUMCD"</span>,</span>
<span>                      strata_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>getwt<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                      returndata <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; savedata=FALSE with savedata parameters... no data are saved</span></span>
<span><span class="co">#&gt; SURVEY table does not exist in database... assuming annual inventory plots</span></span>
<span><span class="co">#&gt; removing nonsampled forest plots...</span></span>
<span><span class="co">#&gt; returning data needed for estimation...</span></span>
<span><span class="co">#&gt; there are 149 nonsampled conditions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">popdatVOL</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "module"        "popType"       "pltidsadj"     "pltcondx"     </span></span>
<span><span class="co">#&gt;  [5] "pltcondflds"   "pjoinid"       "cuniqueid"     "condid"       </span></span>
<span><span class="co">#&gt;  [9] "ACI"           "areawt"        "areawt2"       "adjcase"      </span></span>
<span><span class="co">#&gt; [13] "dbqueries"     "dbqueriesWITH" "pltassgnx"     "pltassgnid"   </span></span>
<span><span class="co">#&gt; [17] "unitarea"      "areavar"       "areaunits"     "unitvar"      </span></span>
<span><span class="co">#&gt; [21] "unitvars"      "unitltmin"     "strata"        "stratalut"    </span></span>
<span><span class="co">#&gt; [25] "strvar"        "strwtvar"      "plotsampcnt"   "condsampcnt"  </span></span>
<span><span class="co">#&gt; [29] "states"        "invyrs"        "adj"           "P2POINTCNT"   </span></span>
<span><span class="co">#&gt; [33] "plotunitcnt"   "treex"         "tuniqueid"     "seedx"        </span></span>
<span><span class="co">#&gt; [37] "evalid"        "adjfactors"    "adjvarlst"     "popdatindb"</span></span>
<span></span>
<span><span class="co">## extract queries from population data</span></span>
<span><span class="va">dbqueries</span> <span class="op">&lt;-</span> <span class="va">popdatVOL</span><span class="op">$</span><span class="va">dbqueries</span></span>
<span><span class="va">dbqueriesWITH</span> <span class="op">&lt;-</span> <span class="va">popdatVOL</span><span class="op">$</span><span class="va">dbqueriesWITH</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dbqueries</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "adjfactors" "pltidsadj"  "pltcondx"   "TREE"       "SEEDLING"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dbqueriesWITH</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "pltidsWITH"      "pltidsadjWITH"   "pltcondxWITH"    "pltcondxadjWITH"</span></span>
<span></span>
<span><span class="co">## look at query for adjustment factors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="va">dbqueries</span><span class="op">$</span><span class="va">adjfactors</span><span class="op">)</span></span>
<span><span class="co">#&gt; WITH</span></span>
<span><span class="co">#&gt; pltids AS</span></span>
<span><span class="co">#&gt; (SELECT 'VOL' AS POP_TYP, p.CN, plta.STATECD, plta.ESTN_UNIT, plta.STRATUMCD</span></span>
<span><span class="co">#&gt; FROM plot p </span></span>
<span><span class="co">#&gt;  JOIN pop_plot_stratum_assgn plta ON (plta.PLT_CN = p.CN)</span></span>
<span><span class="co">#&gt;  WHERE plta.EVALID IN (82101))</span></span>
<span><span class="co">#&gt; -------------------------------------------</span></span>
<span><span class="co">#&gt; SELECT pltids.POP_TYP, pltids.STATECD, pltids.ESTN_UNIT, pltids.STRATUMCD,</span></span>
<span><span class="co">#&gt;    COALESCE(COUNT(DISTINCT pltids.CN) / NULLIF(SUM(CONDPROP_UNADJ),0), 0) AS ADJ_FACTOR_COND,</span></span>
<span><span class="co">#&gt;    COALESCE(COUNT(DISTINCT pltids.CN) / NULLIF(SUM(SUBPPROP_UNADJ),0), 0) AS ADJ_FACTOR_SUBP,</span></span>
<span><span class="co">#&gt;    COALESCE(COUNT(DISTINCT pltids.CN) / NULLIF(SUM(MACRPROP_UNADJ),0), 0) AS ADJ_FACTOR_MACR,</span></span>
<span><span class="co">#&gt;    COALESCE(COUNT(DISTINCT pltids.CN) / NULLIF(SUM(MICRPROP_UNADJ),0), 0) AS ADJ_FACTOR_MICR</span></span>
<span><span class="co">#&gt;  FROM pltids</span></span>
<span><span class="co">#&gt;  JOIN cond c ON (c.PLT_CN = pltids.CN)</span></span>
<span><span class="co">#&gt;  WHERE c.COND_STATUS_CD &lt;&gt; 5</span></span>
<span><span class="co">#&gt;  GROUP BY pltids.POP_TYP, pltids.STATECD, pltids.ESTN_UNIT, pltids.STRATUMCD</span></span>
<span></span>
<span><span class="co">## look at WITH query for getting plots, adjustment factors, and plot/cond data for population</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="va">dbqueriesWITH</span><span class="op">$</span><span class="va">pltcondxadjWITH</span><span class="op">)</span></span>
<span><span class="co">#&gt; WITH</span></span>
<span><span class="co">#&gt; pltids AS</span></span>
<span><span class="co">#&gt; (SELECT 'VOL' AS POP_TYP, p.CN, plta.STATECD, plta.ESTN_UNIT, plta.STRATUMCD</span></span>
<span><span class="co">#&gt; FROM plot p </span></span>
<span><span class="co">#&gt;  JOIN pop_plot_stratum_assgn plta ON (plta.PLT_CN = p.CN)</span></span>
<span><span class="co">#&gt;  WHERE plta.EVALID IN (82101)),</span></span>
<span><span class="co">#&gt; ----- calculate strata-level adjustment factors</span></span>
<span><span class="co">#&gt; adjfactors AS</span></span>
<span><span class="co">#&gt; (SELECT pltids.POP_TYP, pltids.STATECD, pltids.ESTN_UNIT, pltids.STRATUMCD,</span></span>
<span><span class="co">#&gt;    COALESCE(COUNT(DISTINCT pltids.CN) / NULLIF(SUM(CONDPROP_UNADJ),0), 0) AS ADJ_FACTOR_COND,</span></span>
<span><span class="co">#&gt;    COALESCE(COUNT(DISTINCT pltids.CN) / NULLIF(SUM(SUBPPROP_UNADJ),0), 0) AS ADJ_FACTOR_SUBP,</span></span>
<span><span class="co">#&gt;    COALESCE(COUNT(DISTINCT pltids.CN) / NULLIF(SUM(MACRPROP_UNADJ),0), 0) AS ADJ_FACTOR_MACR,</span></span>
<span><span class="co">#&gt;    COALESCE(COUNT(DISTINCT pltids.CN) / NULLIF(SUM(MICRPROP_UNADJ),0), 0) AS ADJ_FACTOR_MICR</span></span>
<span><span class="co">#&gt;  FROM pltids</span></span>
<span><span class="co">#&gt;  JOIN cond c ON (c.PLT_CN = pltids.CN)</span></span>
<span><span class="co">#&gt;  WHERE c.COND_STATUS_CD &lt;&gt; 5</span></span>
<span><span class="co">#&gt;  GROUP BY pltids.POP_TYP, pltids.STATECD, pltids.ESTN_UNIT, pltids.STRATUMCD),</span></span>
<span><span class="co">#&gt; ----- get plot-level adjustment factors</span></span>
<span><span class="co">#&gt; pltidsadj AS </span></span>
<span><span class="co">#&gt; (SELECT pltids.CN, adj.ADJ_FACTOR_COND, adj.ADJ_FACTOR_SUBP, adj.ADJ_FACTOR_MACR, adj.ADJ_FACTOR_MICR</span></span>
<span><span class="co">#&gt; FROM pltids</span></span>
<span><span class="co">#&gt; JOIN adjfactors adj ON (adj.STATECD = pltids.STATECD AND adj.ESTN_UNIT = pltids.ESTN_UNIT AND adj.STRATUMCD = pltids.STRATUMCD)), </span></span>
<span><span class="co">#&gt; ----- pltcondx</span></span>
<span><span class="co">#&gt; pltcondx AS</span></span>
<span><span class="co">#&gt; (SELECT c.PLT_CN, c.CONDID, c.COND_STATUS_CD, c.COND_NONSAMPLE_REASN_CD, c.RESERVCD, c.OWNCD, c.OWNGRPCD, c.ADFORCD, c.FORTYPCD, c.FLDTYPCD, c.MAPDEN, c.STDAGE, c.STDSZCD, c.FLDSZCD, c.SITECLCD, c.SICOND, c.SIBASE, c.SISP, c.STDORGCD, c.STDORGSP, c.PROP_BASIS, c.CONDPROP_UNADJ, c.MICRPROP_UNADJ, c.SUBPPROP_UNADJ, c.MACRPROP_UNADJ, c.SLOPE, c.ASPECT, c.PHYSCLCD, c.GSSTKCD, c.ALSTKCD, c.DSTRBCD1, c.DSTRBYR1, c.DSTRBCD2, c.DSTRBYR2, c.DSTRBCD3, c.DSTRBYR3, c.TRTCD1, c.TRTYR1, c.TRTCD2, c.TRTYR2, c.TRTCD3, c.TRTYR3, c.PRESNFCD, c.BALIVE, c.FLDAGE, c.FORTYPCDCALC, c.HABTYPCD1, c.HABTYPCD2, c.LIVE_CANOPY_CVR_PCT, c.LIVE_MISSING_CANOPY_CVR_PCT, c.CANOPY_CVR_SAMPLE_METHOD_CD, c.CARBON_DOWN_DEAD, c.CARBON_LITTER, c.CARBON_SOIL_ORG, c.CARBON_UNDERSTORY_AG, c.CARBON_UNDERSTORY_BG, c.NF_COND_STATUS_CD, c.NF_COND_NONSAMPLE_REASN_CD, c.LAND_COVER_CLASS_CD, </span></span>
<span><span class="co">#&gt;    (CASE</span></span>
<span><span class="co">#&gt;    WHEN c.FORTYPCD = 100 THEN '100'</span></span>
<span><span class="co">#&gt;    ...</span></span>
<span><span class="co">#&gt;    WHEN c.FORTYPCD = 999 THEN '999' END) AS 'FORTYPGRPCD', </span></span>
<span><span class="co">#&gt; p.STATECD, p.UNITCD, p.COUNTYCD, p.PLOT, p.PLOT_STATUS_CD, p.PLOT_NONSAMPLE_REASN_CD, p.INTENSITY, p.SUBCYCLE, p.MACRO_BREAKPOINT_DIA, p.INVYR, p.MEASYEAR, p.MEASMON, p.RDDISTCD, p.WATERCD, p.ELEV_PUBLIC, p.ECOSUBCD, p.CONGCD, p.DESIGNCD, p.P2PANEL, p.SUBPANEL, p.HUC, p.EMAP_HEX, p.ALP_ADFORCD, p.FVS_VARIANT, p.FVS_LOC_CD, p.FVS_REGION, p.FVS_FOREST, p.FVS_DISTRICT, p.ROADLESSCD, p.NBRCND, p.NBRCNDFOR, p.CCLIVEPLT, 1 AS TOTAL</span></span>
<span><span class="co">#&gt;  FROM pltids</span></span>
<span><span class="co">#&gt;  JOIN plot p ON (p.CN = pltids.CN)</span></span>
<span><span class="co">#&gt;  JOIN cond c ON (c.PLT_CN = p.CN))</span></span>
<span></span>
<span></span>
<span><span class="co">## look at plot/cond data for generating estimates (pltcondx)</span></span>
<span></span>
<span><span class="va">pltcondx</span> <span class="op">&lt;-</span> <span class="va">popdatVOL</span><span class="op">$</span><span class="va">pltcondx</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pltcondx</span><span class="op">)</span></span>
<span><span class="co">#&gt; Key: &lt;PLT_CN, CONDID&gt;</span></span>
<span><span class="co">#&gt;             PLT_CN CONDID COND_STATUS_CD COND_NONSAMPLE_REASN_CD RESERVCD OWNCD</span></span>
<span><span class="co">#&gt;             &lt;char&gt;  &lt;int&gt;          &lt;int&gt;                   &lt;int&gt;    &lt;int&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1: 188756625020004      1              1                      NA        0    11</span></span>
<span><span class="co">#&gt; 2: 188756626020004      1              2                      NA        0    24</span></span>
<span><span class="co">#&gt; 3: 188756627020004      1              2                      NA        0    46</span></span>
<span><span class="co">#&gt; 4: 188756628020004      1              1                      NA        1    11</span></span>
<span><span class="co">#&gt; 5: 188756629020004      1              2                      NA        0    46</span></span>
<span><span class="co">#&gt; 6: 188756630020004      1              2                      NA        0    46</span></span>
<span><span class="co">#&gt;    OWNGRPCD ADFORCD FORTYPCD FLDTYPCD MAPDEN STDAGE STDSZCD FLDSZCD SITECLCD</span></span>
<span><span class="co">#&gt;       &lt;int&gt;   &lt;int&gt;    &lt;int&gt;    &lt;int&gt;  &lt;int&gt;  &lt;int&gt;   &lt;int&gt;   &lt;int&gt;    &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:       10     212      201      201      1    195       1       3        6</span></span>
<span><span class="co">#&gt; 2:       20      NA       NA       NA     NA     NA      NA      NA       NA</span></span>
<span><span class="co">#&gt; 3:       40      NA       NA       NA     NA     NA      NA      NA       NA</span></span>
<span><span class="co">#&gt; 4:       10     212      265      265      1    104       1       3        5</span></span>
<span><span class="co">#&gt; 5:       40      NA       NA       NA     NA     NA      NA      NA       NA</span></span>
<span><span class="co">#&gt; 6:       40      NA       NA       NA     NA     NA      NA      NA       NA</span></span>
<span><span class="co">#&gt;    SICOND SIBASE  SISP STDORGCD STDORGSP PROP_BASIS CONDPROP_UNADJ</span></span>
<span><span class="co">#&gt;     &lt;int&gt;  &lt;int&gt; &lt;int&gt;    &lt;int&gt;    &lt;num&gt;     &lt;char&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:     29     50   202        0       NA       SUBP              1</span></span>
<span><span class="co">#&gt; 2:     NA     NA    NA       NA       NA       SUBP              1</span></span>
<span><span class="co">#&gt; 3:     NA     NA    NA       NA       NA       SUBP              1</span></span>
<span><span class="co">#&gt; 4:     41     50    93        0       NA       SUBP              1</span></span>
<span><span class="co">#&gt; 5:     NA     NA    NA       NA       NA       SUBP              1</span></span>
<span><span class="co">#&gt; 6:     NA     NA    NA       NA       NA       SUBP              1</span></span>
<span><span class="co">#&gt;    MICRPROP_UNADJ SUBPPROP_UNADJ MACRPROP_UNADJ SLOPE ASPECT PHYSCLCD GSSTKCD</span></span>
<span><span class="co">#&gt;             &lt;num&gt;          &lt;num&gt;          &lt;num&gt; &lt;int&gt;  &lt;int&gt;    &lt;int&gt;   &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:              1              1             NA    62     83       22       4</span></span>
<span><span class="co">#&gt; 2:              1              1             NA    NA     NA       NA      NA</span></span>
<span><span class="co">#&gt; 3:              1              1             NA    NA     NA       NA      NA</span></span>
<span><span class="co">#&gt; 4:              1              1             NA    45    109       22       2</span></span>
<span><span class="co">#&gt; 5:              1              1             NA    NA     NA       NA      NA</span></span>
<span><span class="co">#&gt; 6:              1              1             NA    NA     NA       NA      NA</span></span>
<span><span class="co">#&gt;    ALSTKCD DSTRBCD1 DSTRBYR1 DSTRBCD2 DSTRBYR2 DSTRBCD3 DSTRBYR3 TRTCD1 TRTYR1</span></span>
<span><span class="co">#&gt;      &lt;int&gt;    &lt;int&gt;    &lt;int&gt;    &lt;int&gt;    &lt;int&gt;    &lt;int&gt;    &lt;int&gt;  &lt;int&gt;  &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:       4        0       NA        0       NA        0       NA      0     NA</span></span>
<span><span class="co">#&gt; 2:      NA       NA       NA       NA       NA       NA       NA     NA     NA</span></span>
<span><span class="co">#&gt; 3:      NA       NA       NA       NA       NA       NA       NA     NA     NA</span></span>
<span><span class="co">#&gt; 4:       2        0       NA        0       NA        0       NA      0     NA</span></span>
<span><span class="co">#&gt; 5:      NA       NA       NA       NA       NA       NA       NA     NA     NA</span></span>
<span><span class="co">#&gt; 6:      NA       NA       NA       NA       NA       NA       NA     NA     NA</span></span>
<span><span class="co">#&gt;    TRTCD2 TRTYR2 TRTCD3 TRTYR3 PRESNFCD   BALIVE FLDAGE FORTYPCDCALC HABTYPCD1</span></span>
<span><span class="co">#&gt;     &lt;int&gt;  &lt;int&gt;  &lt;int&gt;  &lt;int&gt;    &lt;int&gt;    &lt;num&gt;  &lt;int&gt;        &lt;int&gt;     &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:      0     NA      0     NA       NA  62.9944    999          201      1209</span></span>
<span><span class="co">#&gt; 2:     NA     NA     NA     NA       20       NA     NA           NA        NA</span></span>
<span><span class="co">#&gt; 3:     NA     NA     NA     NA       10       NA     NA           NA        NA</span></span>
<span><span class="co">#&gt; 4:      0     NA      0     NA       NA 176.2260    999          265       407</span></span>
<span><span class="co">#&gt; 5:     NA     NA     NA     NA       31       NA     NA           NA        NA</span></span>
<span><span class="co">#&gt; 6:     NA     NA     NA     NA       11       NA     NA           NA        NA</span></span>
<span><span class="co">#&gt;    HABTYPCD2 LIVE_CANOPY_CVR_PCT LIVE_MISSING_CANOPY_CVR_PCT</span></span>
<span><span class="co">#&gt;        &lt;int&gt;               &lt;int&gt;                       &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:      1209                  25                          26</span></span>
<span><span class="co">#&gt; 2:        NA                   0                           0</span></span>
<span><span class="co">#&gt; 3:        NA                   0                           0</span></span>
<span><span class="co">#&gt; 4:       407                  67                          68</span></span>
<span><span class="co">#&gt; 5:        NA                   2                           2</span></span>
<span><span class="co">#&gt; 6:        NA                   0                           0</span></span>
<span><span class="co">#&gt;    CANOPY_CVR_SAMPLE_METHOD_CD CARBON_DOWN_DEAD CARBON_LITTER CARBON_SOIL_ORG</span></span>
<span><span class="co">#&gt;                          &lt;int&gt;            &lt;num&gt;         &lt;num&gt;           &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:                           1         2.460093      5.755115        43.31157</span></span>
<span><span class="co">#&gt; 2:                          11               NA            NA              NA</span></span>
<span><span class="co">#&gt; 3:                          11               NA            NA              NA</span></span>
<span><span class="co">#&gt; 4:                           1         5.589381     10.025406        69.26936</span></span>
<span><span class="co">#&gt; 5:                          11               NA            NA              NA</span></span>
<span><span class="co">#&gt; 6:                          11               NA            NA              NA</span></span>
<span><span class="co">#&gt;    CARBON_UNDERSTORY_AG CARBON_UNDERSTORY_BG NF_COND_STATUS_CD</span></span>
<span><span class="co">#&gt;                   &lt;num&gt;                &lt;num&gt;             &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:             0.355146             0.039461                NA</span></span>
<span><span class="co">#&gt; 2:                   NA                   NA                NA</span></span>
<span><span class="co">#&gt; 3:                   NA                   NA                NA</span></span>
<span><span class="co">#&gt; 4:             0.393330             0.043703                NA</span></span>
<span><span class="co">#&gt; 5:                   NA                   NA                NA</span></span>
<span><span class="co">#&gt; 6:                   NA                   NA                NA</span></span>
<span><span class="co">#&gt;    NF_COND_NONSAMPLE_REASN_CD LAND_COVER_CLASS_CD FORTYPGRPCD STATECD UNITCD</span></span>
<span><span class="co">#&gt;                         &lt;int&gt;               &lt;int&gt;      &lt;char&gt;   &lt;int&gt;  &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:                         NA                  NA         200       8      1</span></span>
<span><span class="co">#&gt; 2:                         NA                  NA        &lt;NA&gt;       8      1</span></span>
<span><span class="co">#&gt; 3:                         NA                  NA        &lt;NA&gt;       8      2</span></span>
<span><span class="co">#&gt; 4:                         NA                  NA         260       8      2</span></span>
<span><span class="co">#&gt; 5:                         NA                  NA        &lt;NA&gt;       8      5</span></span>
<span><span class="co">#&gt; 6:                         NA                  NA        &lt;NA&gt;       8      5</span></span>
<span><span class="co">#&gt;    COUNTYCD  PLOT PLOT_STATUS_CD PLOT_NONSAMPLE_REASN_CD INTENSITY SUBCYCLE</span></span>
<span><span class="co">#&gt;       &lt;int&gt; &lt;int&gt;          &lt;int&gt;                   &lt;int&gt;     &lt;int&gt;    &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:       41 89494              1                      NA         1        3</span></span>
<span><span class="co">#&gt; 2:       41 84260              2                      NA         1        3</span></span>
<span><span class="co">#&gt; 3:      101 83332              2                      NA         1        3</span></span>
<span><span class="co">#&gt; 4:       71 81232              1                      NA         1        3</span></span>
<span><span class="co">#&gt; 5:        5 80210              2                      NA         1        3</span></span>
<span><span class="co">#&gt; 6:       99 89606              2                      NA         1        3</span></span>
<span><span class="co">#&gt;    MACRO_BREAKPOINT_DIA INVYR MEASYEAR MEASMON RDDISTCD WATERCD ELEV_PUBLIC</span></span>
<span><span class="co">#&gt;                   &lt;int&gt; &lt;int&gt;    &lt;int&gt;   &lt;int&gt;    &lt;int&gt;   &lt;int&gt;       &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:                   NA  2014     2014       9        6       0        8970</span></span>
<span><span class="co">#&gt; 2:                   NA  2014     2014       9       NA      NA        6020</span></span>
<span><span class="co">#&gt; 3:                   NA  2014     2014       9       NA      NA        5200</span></span>
<span><span class="co">#&gt; 4:                   NA  2014     2014       7        7       0       11620</span></span>
<span><span class="co">#&gt; 5:                   NA  2014     2014       9       NA      NA        5250</span></span>
<span><span class="co">#&gt; 6:                   NA  2014     2014       9       NA      NA        3860</span></span>
<span><span class="co">#&gt;    ECOSUBCD CONGCD DESIGNCD P2PANEL SUBPANEL      HUC EMAP_HEX ALP_ADFORCD</span></span>
<span><span class="co">#&gt;      &lt;char&gt;  &lt;num&gt;    &lt;int&gt;   &lt;int&gt;    &lt;int&gt;    &lt;num&gt;    &lt;num&gt;       &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:   M331In    805        1       1        2 11020003    18328         212</span></span>
<span><span class="co">#&gt; 2:    331Ii    805        1       1        2 11020003    18159          NA</span></span>
<span><span class="co">#&gt; 3:    331If    803        1       1        2 11020002    18161          NA</span></span>
<span><span class="co">#&gt; 4:   M331Fa    803        1       1        2 11020007    18165         212</span></span>
<span><span class="co">#&gt; 5:    331Hc    806        1       1        2 10190002    18325          NA</span></span>
<span><span class="co">#&gt; 6:    331Ia    804        1       1        2 11020009    16591          NA</span></span>
<span><span class="co">#&gt;    FVS_VARIANT FVS_LOC_CD FVS_REGION FVS_FOREST FVS_DISTRICT ROADLESSCD NBRCND</span></span>
<span><span class="co">#&gt;         &lt;char&gt;      &lt;int&gt;      &lt;int&gt;      &lt;int&gt;        &lt;int&gt;     &lt;char&gt;  &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:          CR        208          2          8           NA                 1</span></span>
<span><span class="co">#&gt; 2:          CR        207          2          7           NA                 1</span></span>
<span><span class="co">#&gt; 3:          CR        207          2          7           NA                 1</span></span>
<span><span class="co">#&gt; 4:          CR        212          2         12           NA         1B      1</span></span>
<span><span class="co">#&gt; 5:          CR        207          2          7           NA                 1</span></span>
<span><span class="co">#&gt; 6:          CR        207          2          7           NA                 1</span></span>
<span><span class="co">#&gt;    NBRCNDFOR CCLIVEPLT TOTAL LANDSTATUSCD                   LANDSTATUSNM</span></span>
<span><span class="co">#&gt;        &lt;num&gt;     &lt;num&gt; &lt;int&gt;        &lt;num&gt;                         &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:         1        25     1            1                     Timberland</span></span>
<span><span class="co">#&gt; 2:         0         0     1           NA                           &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3:         0         0     1           NA                           &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4:         1        67     1            3 Reserved productive forestland</span></span>
<span><span class="co">#&gt; 5:         0         2     1           NA                           &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6:         0         0     1           NA                           &lt;NA&gt;</span></span>
<span><span class="co">#&gt;    DSTRBGRP</span></span>
<span><span class="co">#&gt;      &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:        0</span></span>
<span><span class="co">#&gt; 2:     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3:     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4:        0</span></span>
<span><span class="co">#&gt; 5:     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6:     &lt;NA&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">pltcondx</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 12083    96</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">pltcondx</span><span class="op">$</span><span class="va">STATECD</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     8 </span></span>
<span><span class="co">#&gt; 12083</span></span>
<span>  </span>
<span>  <span class="co">## List variable names in tree table (treex)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">popdatVOL</span><span class="op">$</span><span class="va">treex</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "CN"                  "PLT_CN"              "PREV_TRE_CN"        </span></span>
<span><span class="co">#&gt;  [4] "SUBP"                "TREE"                "CONDID"             </span></span>
<span><span class="co">#&gt;  [7] "STATUSCD"            "SPCD"                "SPGRPCD"            </span></span>
<span><span class="co">#&gt; [10] "DIA"                 "HT"                  "ACTUALHT"           </span></span>
<span><span class="co">#&gt; [13] "HTCD"                "TREECLCD"            "CR"                 </span></span>
<span><span class="co">#&gt; [16] "CCLCD"               "AGENTCD"             "CULL"               </span></span>
<span><span class="co">#&gt; [19] "DECAYCD"             "STOCKING"            "WDLDSTEM"           </span></span>
<span><span class="co">#&gt; [22] "MORTYR"              "UNCRCD"              "BHAGE"              </span></span>
<span><span class="co">#&gt; [25] "TOTAGE"              "MORTCD"              "MIST_CL_CD"         </span></span>
<span><span class="co">#&gt; [28] "STANDING_DEAD_CD"    "PREV_STATUS_CD"      "PREV_WDLDSTEM"      </span></span>
<span><span class="co">#&gt; [31] "RECONCILECD"         "PREVDIA"             "VOLCFGRS"           </span></span>
<span><span class="co">#&gt; [34] "VOLCFGRS_BARK"       "VOLCFGRS_STUMP"      "VOLCFGRS_STUMP_BARK"</span></span>
<span><span class="co">#&gt; [37] "VOLCFGRS_TOP"        "VOLCFGRS_TOP_BARK"   "VOLCFNET"           </span></span>
<span><span class="co">#&gt; [40] "VOLCFNET_BARK"       "VOLCFSND"            "VOLCFSND_BARK"      </span></span>
<span><span class="co">#&gt; [43] "VOLCFSND_STUMP"      "VOLCFSND_STUMP_BARK" "VOLCFSND_TOP"       </span></span>
<span><span class="co">#&gt; [46] "VOLCFSND_TOP_BARK"   "VOLCSGRS"            "VOLCSGRS_BARK"      </span></span>
<span><span class="co">#&gt; [49] "VOLCSNET"            "VOLCSNET_BARK"       "VOLCSSND"           </span></span>
<span><span class="co">#&gt; [52] "VOLCSSND_BARK"       "VOLTSGRS"            "VOLTSGRS_BARK"      </span></span>
<span><span class="co">#&gt; [55] "VOLTSSND"            "VOLTSSND_BARK"       "VOLBFGRS"           </span></span>
<span><span class="co">#&gt; [58] "VOLBFNET"            "VOLBSGRS"            "VOLBSNET"           </span></span>
<span><span class="co">#&gt; [61] "TPA_UNADJ"           "DRYBIO_AG"           "DRYBIO_BG"          </span></span>
<span><span class="co">#&gt; [64] "DRYBIO_BOLE"         "DRYBIO_BOLE_BARK"    "DRYBIO_BRANCH"      </span></span>
<span><span class="co">#&gt; [67] "DRYBIO_FOLIAGE"      "DRYBIO_SAWLOG"       "DRYBIO_SAWLOG_BARK" </span></span>
<span><span class="co">#&gt; [70] "DRYBIO_STEM"         "DRYBIO_STEM_BARK"    "DRYBIO_STUMP"       </span></span>
<span><span class="co">#&gt; [73] "DRYBIO_STUMP_BARK"   "CARBON_BG"           "CARBON_AG"          </span></span>
<span><span class="co">#&gt; [76] "tadjfac"</span></span>
<span></span>
<span></span>
<span><span class="co">## extract adjustment factors from population data to compare to EVALIDator</span></span>
<span><span class="va">adjfactors</span> <span class="op">&lt;-</span> <span class="va">popdatVOL</span><span class="op">$</span><span class="va">adjfactors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">adjfactors</span><span class="op">)</span></span>
<span><span class="co">#&gt; Key: &lt;STATECD, ESTN_UNIT, STRATUMCD&gt;</span></span>
<span><span class="co">#&gt;    POP_TYP STATECD ESTN_UNIT STRATUMCD ADJ_FACTOR_COND ADJ_FACTOR_SUBP</span></span>
<span><span class="co">#&gt;     &lt;char&gt;   &lt;int&gt;     &lt;int&gt;     &lt;int&gt;           &lt;num&gt;           &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:     VOL       8         1        56        1.000000        1.000000</span></span>
<span><span class="co">#&gt; 2:     VOL       8         3        46        1.000000        1.000000</span></span>
<span><span class="co">#&gt; 3:     VOL       8         3       135        1.000000        1.000000</span></span>
<span><span class="co">#&gt; 4:     VOL       8         5      7777        1.000000        1.000000</span></span>
<span><span class="co">#&gt; 5:     VOL       8         7         1        1.000000        1.000000</span></span>
<span><span class="co">#&gt; 6:     VOL       8         7         2        1.043478        1.043478</span></span>
<span><span class="co">#&gt;    ADJ_FACTOR_MACR ADJ_FACTOR_MICR</span></span>
<span><span class="co">#&gt;              &lt;int&gt;           &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:               0        1.000000</span></span>
<span><span class="co">#&gt; 2:               0        1.000000</span></span>
<span><span class="co">#&gt; 3:               0        1.000000</span></span>
<span><span class="co">#&gt; 4:               0        1.000000</span></span>
<span><span class="co">#&gt; 5:               0        1.000000</span></span>
<span><span class="co">#&gt; 6:               0        1.043478</span></span></code></pre>
<p>Next, we can check to see whether the adjustment factors from the
FIESTA population data match the adjustment factor from FIADB. The
function <code>checkpop</code> returns the rows where the adjustment
factors differ, meaning we should expect to see zero rows returned
here.</p>
<pre><code><span><span class="co">## Get POP_STRATUM with adjustment factors for evalid</span></span>
<span><span class="va">FIADBpop</span> <span class="op">&lt;-</span> <span class="fu">getFIADBpop</span><span class="op">(</span>evalid <span class="op">=</span> <span class="va">evalidVOL</span>, </span>
<span>                        dbconn <span class="op">=</span> <span class="va">dbconn</span><span class="op">)</span><span class="op">$</span><span class="va">pop_stratum</span></span>
<span><span class="co">#&gt; querying pop tables from database...</span></span>
<span></span>
<span><span class="co">## Compare adjustment factors from FIESTA to adjustment factors from FIADB</span></span>
<span><span class="va">pop_compare</span> <span class="op">&lt;-</span> <span class="fu">checkpop</span><span class="op">(</span><span class="va">FIADBpop</span>, </span>
<span>                        FIESTApop <span class="op">=</span> <span class="va">popdatVOL</span><span class="op">$</span><span class="va">adjfactors</span>, </span>
<span>                        evalendType <span class="op">=</span> <span class="va">evalendTypeVOL</span>, </span>
<span>                        rnd <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">pop_compare</span></span>
<span><span class="co">#&gt; Key: &lt;estn_unit, stratumcd&gt;</span></span>
<span><span class="co">#&gt; Empty data.table (0 rows and 14 cols): estn_unit,stratumcd,statecd,expns_fiadb,p2pointcnt_fiadb,adj_factor_subp_fiadb...</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="area-estimates">Area estimates<a class="anchor" aria-label="anchor" href="#area-estimates"></a>
</h2>
<p>We now move on to actually generating estimates with FIESTA and with
the EVALIDator API to see if we can produce the same results. To begin
we’ll work through a handful of estimates for area. For each example we
list the EVALIDator estimate attribute number (parameter
<code>snum</code> in the API) as well as it’s description.</p>
<div class="section level3">
<h3 id="example-1">Example 1<a class="anchor" aria-label="anchor" href="#example-1"></a>
</h3>
<p>0002 Area of forest land, in acres by forest type and stand-size
class.</p>
<p>We start by producing estimates in FIESTA:</p>
<pre><code><span><span class="co">## Set parameters</span></span>
<span><span class="va">landarea</span> <span class="op">=</span> <span class="st">"FOREST"</span></span>
<span><span class="va">rowvar</span> <span class="op">=</span> <span class="st">"FORTYPCD"</span></span>
<span><span class="va">colvar</span> <span class="op">=</span> <span class="st">"STDSZCD"</span></span>
<span></span>
<span><span class="co">## Get estimates using GB module</span></span>
<span><span class="va">areaest1</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/modGBarea.html">modGBarea</a></span><span class="op">(</span>GBpopdat <span class="op">=</span> <span class="va">popdatVOL</span>, </span>
<span>            landarea <span class="op">=</span> <span class="va">landarea</span>,</span>
<span>            rowvar <span class="op">=</span> <span class="va">rowvar</span>,</span>
<span>            colvar <span class="op">=</span> <span class="va">colvar</span>,</span>
<span>            table_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>row.FIAname <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                              col.FIAname <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>            <span class="op">)</span></span>
<span><span class="co">#&gt; getting estimates using GB...</span></span>
<span><span class="co">#&gt; getting output...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">areaest1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "est"     "pse"     "raw"     "statecd" "states"  "invyr"</span></span>
<span></span>
<span><span class="co">## Look at estimates (est) and percent standard errors (pse) and compare with EVALIDator</span></span>
<span><span class="va">areaest1</span><span class="op">$</span><span class="va">est</span>  </span>
<span><span class="co">#&gt;                                 Forest type Large diameter Medium diameter</span></span>
<span><span class="co">#&gt; 1                    Rocky Mountain juniper       519737.8         24081.9</span></span>
<span><span class="co">#&gt; 2                          Juniper woodland      1089171.5         20386.3</span></span>
<span><span class="co">#&gt; 3                 Pinyon / juniper woodland      4149531.4        400413.6</span></span>
<span><span class="co">#&gt; 4                               Douglas-fir      1258582.7          211782</span></span>
<span><span class="co">#&gt; 5                            Ponderosa pine      1301600.3         65335.5</span></span>
<span><span class="co">#&gt; 6                                 White fir       211180.1         16615.9</span></span>
<span><span class="co">#&gt; 7                          Engelmann spruce      1274963.8          237463</span></span>
<span><span class="co">#&gt; 8          Engelmann spruce / subalpine fir      1311577.1        413122.5</span></span>
<span><span class="co">#&gt; 9                             Subalpine fir       264371.3        136425.9</span></span>
<span><span class="co">#&gt; 10                              Blue spruce         131814         40001.4</span></span>
<span><span class="co">#&gt; 11                           Lodgepole pine       444725.9        681818.6</span></span>
<span><span class="co">#&gt; 12                  Southwestern white pine         4192.2              --</span></span>
<span><span class="co">#&gt; 13          Foxtail pine / bristlecone pine          86534         16844.2</span></span>
<span><span class="co">#&gt; 14                              Limber pine       132659.7          7717.9</span></span>
<span><span class="co">#&gt; 15                               Cottonwood        98931.2            1758</span></span>
<span><span class="co">#&gt; 16 Sugarberry / hackberry / elm / green ash         3160.6          2452.9</span></span>
<span><span class="co">#&gt; 17                      Cottonwood / willow         9017.8              --</span></span>
<span><span class="co">#&gt; 18                                    Aspen         889276       1608515.6</span></span>
<span><span class="co">#&gt; 19                          Other hardwoods             --              --</span></span>
<span><span class="co">#&gt; 20                   Deciduous oak woodland        63909.1        307973.8</span></span>
<span><span class="co">#&gt; 21    Cercocarpus (mountain brush) woodland        27395.2          1647.3</span></span>
<span><span class="co">#&gt; 22                   Other exotic hardwoods             --          8174.6</span></span>
<span><span class="co">#&gt; 23                               Nonstocked             --              --</span></span>
<span><span class="co">#&gt; 24                                    Total     13272331.7         4202531</span></span>
<span><span class="co">#&gt;    Small diameter Nonstocked      Total</span></span>
<span><span class="co">#&gt; 1         14612.4         --   558432.1</span></span>
<span><span class="co">#&gt; 2         25123.4         --  1134681.2</span></span>
<span><span class="co">#&gt; 3        167053.5         --  4716998.6</span></span>
<span><span class="co">#&gt; 4         40663.2         --  1511027.9</span></span>
<span><span class="co">#&gt; 5         63990.2         --  1430925.9</span></span>
<span><span class="co">#&gt; 6          1966.2         --   229762.2</span></span>
<span><span class="co">#&gt; 7        318812.8         --  1831239.6</span></span>
<span><span class="co">#&gt; 8          216918         --  1941617.5</span></span>
<span><span class="co">#&gt; 9        138848.7         --   539645.9</span></span>
<span><span class="co">#&gt; 10           6032         --   177847.4</span></span>
<span><span class="co">#&gt; 11       268957.1         --  1395501.7</span></span>
<span><span class="co">#&gt; 12             --         --     4192.2</span></span>
<span><span class="co">#&gt; 13        11488.5         --   114866.7</span></span>
<span><span class="co">#&gt; 14           6833         --   147210.6</span></span>
<span><span class="co">#&gt; 15         5633.8         --     106323</span></span>
<span><span class="co">#&gt; 16             --         --     5613.6</span></span>
<span><span class="co">#&gt; 17             --         --     9017.8</span></span>
<span><span class="co">#&gt; 18       972001.7         --  3469793.2</span></span>
<span><span class="co">#&gt; 19         6967.2         --     6967.2</span></span>
<span><span class="co">#&gt; 20        2153953         --  2525835.9</span></span>
<span><span class="co">#&gt; 21             --         --    29042.5</span></span>
<span><span class="co">#&gt; 22         4414.2         --    12588.8</span></span>
<span><span class="co">#&gt; 23             --   813300.1   813300.1</span></span>
<span><span class="co">#&gt; 24      4424268.8   813300.1 22712431.6</span></span></code></pre>
<p>Next we can use the function getAPIest to get EVALIDator estimates
for the same population:</p>
<pre><code><span><span class="co">## Get estimate from EVALIDator API</span></span>
<span><span class="va">APIest</span> <span class="op">&lt;-</span> <span class="fu">getAPIest</span><span class="op">(</span>evalid <span class="op">=</span> <span class="va">evalidVOL</span>,</span>
<span>                    landarea <span class="op">=</span> <span class="va">landarea</span>,</span>
<span>                    rowvar <span class="op">=</span> <span class="va">rowvar</span>,</span>
<span>                    colvar <span class="op">=</span> <span class="va">colvar</span>,</span>
<span>                    EVALIDATOR_POP_ESTIMATE <span class="op">=</span> <span class="va">EVALIDATOR_POP_ESTIMATE</span><span class="op">)</span></span>
<span><span class="co">#&gt; EVALIDATOR_POP_ESTIMATE missing key variables: attribute_nbr, attribute_descr, estn_type</span></span>
<span><span class="co">#&gt; attribute number 2: </span></span>
<span><span class="co">#&gt; Area of forest land, in acres</span></span>
<span><span class="co">#&gt;     by Forest type and Stand-size class</span></span>
<span><span class="va">APIest</span><span class="op">$</span><span class="va">eval_rowest</span></span>
<span><span class="co">#&gt;    ESTIMATE                                                 GRP2 PLOT_COUNT</span></span>
<span><span class="co">#&gt; 1  558432.1                         `0182 Rocky Mountain juniper        101</span></span>
<span><span class="co">#&gt; 2   1134681                               `0184 Juniper woodland        210</span></span>
<span><span class="co">#&gt; 3   4716999                    `0185 Pinyon \\/ juniper woodland        809</span></span>
<span><span class="co">#&gt; 4   1511028                                    `0201 Douglas-fir        290</span></span>
<span><span class="co">#&gt; 5   1430926                                 `0221 Ponderosa pine        275</span></span>
<span><span class="co">#&gt; 6  229762.2                                      `0261 White fir         43</span></span>
<span><span class="co">#&gt; 7   1831240                               `0265 Engelmann spruce        342</span></span>
<span><span class="co">#&gt; 8   1941618             `0266 Engelmann spruce \\/ subalpine fir        359</span></span>
<span><span class="co">#&gt; 9  539645.9                                  `0268 Subalpine fir        107</span></span>
<span><span class="co">#&gt; 10 177847.4                                    `0269 Blue spruce         37</span></span>
<span><span class="co">#&gt; 11  1395502                                 `0281 Lodgepole pine        249</span></span>
<span><span class="co">#&gt; 12 4192.193                        `0362 Southwestern white pine          1</span></span>
<span><span class="co">#&gt; 13 114866.7              `0365 Foxtail pine \\/ bristlecone pine         27</span></span>
<span><span class="co">#&gt; 14 147210.6                                    `0366 Limber pine         28</span></span>
<span><span class="co">#&gt; 15   106323                                     `0703 Cottonwood         23</span></span>
<span><span class="co">#&gt; 16 5613.572 `0706 Sugarberry \\/ hackberry \\/ elm \\/ green ash          2</span></span>
<span><span class="co">#&gt; 17 9017.829                          `0709 Cottonwood \\/ willow          1</span></span>
<span><span class="co">#&gt; 18  3469793                                          `0901 Aspen        659</span></span>
<span><span class="co">#&gt; 19 6967.227                                `0962 Other hardwoods          2</span></span>
<span><span class="co">#&gt; 20  2525836                         `0971 Deciduous oak woodland        442</span></span>
<span><span class="co">#&gt; 21 29042.49          `0974 Cercocarpus (mountain brush) woodland          5</span></span>
<span><span class="co">#&gt; 22  12588.8                         `0995 Other exotic hardwoods          2</span></span>
<span><span class="co">#&gt; 23 813300.1                                     `0999 Nonstocked        194</span></span>
<span><span class="co">#&gt;          SE SE_PERCENT    VARIANCE</span></span>
<span><span class="co">#&gt; 1  56087.68   10.04378  3145827784</span></span>
<span><span class="co">#&gt; 2  75291.91   6.635513  5668872255</span></span>
<span><span class="co">#&gt; 3  132279.4   2.804312 17497831620</span></span>
<span><span class="co">#&gt; 4  87116.91   5.765407  7589356136</span></span>
<span><span class="co">#&gt; 5  83466.72   5.833056  6966693171</span></span>
<span><span class="co">#&gt; 6  36805.56   16.01898  1354649368</span></span>
<span><span class="co">#&gt; 7  95706.71   5.226335  9159774025</span></span>
<span><span class="co">#&gt; 8   97246.4   5.008525  9456862363</span></span>
<span><span class="co">#&gt; 9  53315.89   9.879792  2842584346</span></span>
<span><span class="co">#&gt; 10 31122.34   17.49946   968599915</span></span>
<span><span class="co">#&gt; 11 80719.38   5.784255  6515617999</span></span>
<span><span class="co">#&gt; 12 4567.055   108.9419    20857992</span></span>
<span><span class="co">#&gt; 13 24680.73   21.48641   609138391</span></span>
<span><span class="co">#&gt; 14 29298.74    19.9026   858416308</span></span>
<span><span class="co">#&gt; 15 24212.21   22.77232   586231017</span></span>
<span><span class="co">#&gt; 16 3861.984   68.79727    14914924</span></span>
<span><span class="co">#&gt; 17 7716.041   85.56429    59537294</span></span>
<span><span class="co">#&gt; 18   125530   3.617794 15757775065</span></span>
<span><span class="co">#&gt; 19 6043.163     86.737    36519820</span></span>
<span><span class="co">#&gt; 20 108437.6   4.293138 11758716160</span></span>
<span><span class="co">#&gt; 21 13116.99   45.16483   172055448</span></span>
<span><span class="co">#&gt; 22 8650.144     68.713    74824990</span></span>
<span><span class="co">#&gt; 23 63511.96   7.809167  4033769361</span></span></code></pre>
<p>Finally we can use the function compareAPI to check whether all of
the estimates match up.</p>
<pre><code><span><span class="co">## Compare estimates - Row</span></span>
<span><span class="fu">compareAPI</span><span class="op">(</span>EVALIDatorlst <span class="op">=</span> <span class="va">APIest</span>,</span>
<span>           FIESTAlst <span class="op">=</span> <span class="va">areaest1</span>,</span>
<span>           compareType <span class="op">=</span> <span class="st">"ROW"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; All estimates match</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span></span>
<span><span class="co">## Compare estimates - Column</span></span>
<span><span class="fu">compareAPI</span><span class="op">(</span>EVALIDatorlst <span class="op">=</span> <span class="va">APIest</span>,</span>
<span>           FIESTAlst <span class="op">=</span> <span class="va">areaest1</span>,</span>
<span>           compareType <span class="op">=</span> <span class="st">"COL"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; All estimates match</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span></span>
<span><span class="co">## Compare estimates - Group</span></span>
<span><span class="fu">compareAPI</span><span class="op">(</span>EVALIDatorlst <span class="op">=</span> <span class="va">APIest</span>,</span>
<span>           FIESTAlst <span class="op">=</span> <span class="va">areaest1</span>,</span>
<span>           compareType <span class="op">=</span> <span class="st">"GRP"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; All estimates match</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="example-2">Example 2<a class="anchor" aria-label="anchor" href="#example-2"></a>
</h3>
<p>0079 Area of sampled land and water, in acres, by distance to road
and owner class.</p>
<pre><code><span><span class="co">## Set parameters</span></span>
<span><span class="va">landarea</span> <span class="op">=</span> <span class="st">"ALL"</span></span>
<span><span class="va">rowvar</span> <span class="op">=</span> <span class="st">"RDDISTCD"</span></span>
<span><span class="va">colvar</span> <span class="op">=</span> <span class="st">"OWNCD"</span></span>
<span></span>
<span><span class="co">## Get estimates using GB module</span></span>
<span><span class="va">areaest2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/modGBarea.html">modGBarea</a></span><span class="op">(</span>GBpopdat <span class="op">=</span> <span class="va">popdatVOL</span>, </span>
<span>            landarea <span class="op">=</span> <span class="va">landarea</span>,</span>
<span>            rowvar <span class="op">=</span> <span class="va">rowvar</span>,</span>
<span>            colvar <span class="op">=</span> <span class="va">colvar</span>,</span>
<span>            table_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>row.FIAname <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                              col.FIAname <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>            <span class="op">)</span></span>
<span></span>
<span><span class="co">## Get estimate from EVALIDator API</span></span>
<span><span class="va">APIest</span> <span class="op">&lt;-</span> <span class="fu">getAPIest</span><span class="op">(</span>evalid <span class="op">=</span> <span class="va">evalidVOL</span>,</span>
<span>                    landarea <span class="op">=</span> <span class="va">landarea</span>,</span>
<span>                    rowvar <span class="op">=</span> <span class="va">rowvar</span>,</span>
<span>                    colvar <span class="op">=</span> <span class="va">colvar</span>,</span>
<span>                    EVALIDATOR_POP_ESTIMATE <span class="op">=</span> <span class="va">EVALIDATOR_POP_ESTIMATE</span><span class="op">)</span></span></code></pre>
<p>Once again we can see that all of the estimates match up:</p>
<pre><code><span><span class="co">## Compare estimates - Row</span></span>
<span><span class="fu">compareAPI</span><span class="op">(</span>EVALIDatorlst <span class="op">=</span> <span class="va">APIest</span>,</span>
<span>           FIESTAlst <span class="op">=</span> <span class="va">areaest2</span>,</span>
<span>           compareType <span class="op">=</span> <span class="st">"ROW"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; All estimates match</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span></span>
<span><span class="co">## Compare estimates - Column</span></span>
<span><span class="fu">compareAPI</span><span class="op">(</span>EVALIDatorlst <span class="op">=</span> <span class="va">APIest</span>,</span>
<span>           FIESTAlst <span class="op">=</span> <span class="va">areaest2</span>,</span>
<span>           compareType <span class="op">=</span> <span class="st">"COL"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; All estimates match</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span></span>
<span><span class="co">## Compare estimates - Group</span></span>
<span><span class="fu">compareAPI</span><span class="op">(</span>EVALIDatorlst <span class="op">=</span> <span class="va">APIest</span>,</span>
<span>           FIESTAlst <span class="op">=</span> <span class="va">areaest2</span>,</span>
<span>           compareType <span class="op">=</span> <span class="st">"GRP"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; All estimates match</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="tree-estimates">Tree estimates<a class="anchor" aria-label="anchor" href="#tree-estimates"></a>
</h2>
<div class="section level3">
<h3 id="example-1-1">Example 1<a class="anchor" aria-label="anchor" href="#example-1-1"></a>
</h3>
<p>0004 Number of live trees (at least 1 inch d.b.h./d.r.c.), in trees,
on forest land by forest type and #stand-size class.</p>
<pre><code><span><span class="va">landarea</span> <span class="op">=</span> <span class="st">"FOREST"</span></span>
<span><span class="va">estvar</span> <span class="op">=</span> <span class="st">"TPA_UNADJ"</span></span>
<span><span class="va">estvar.filter</span> <span class="op">=</span> <span class="st">"STATUSCD == 1"</span></span>
<span><span class="va">rowvar</span> <span class="op">=</span> <span class="st">"FORTYPCD"</span></span>
<span><span class="va">colvar</span> <span class="op">=</span> <span class="st">"STDSZCD"</span></span>
<span></span>
<span><span class="co">## Get estimates using GB module</span></span>
<span><span class="va">treeest1</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/modGBtree.html">modGBtree</a></span><span class="op">(</span>GBpopdat <span class="op">=</span> <span class="va">popdatVOL</span>, </span>
<span>            landarea <span class="op">=</span> <span class="va">landarea</span>,</span>
<span>            rowvar <span class="op">=</span> <span class="va">rowvar</span>,</span>
<span>            colvar <span class="op">=</span> <span class="va">colvar</span>,</span>
<span>            estvar <span class="op">=</span> <span class="va">estvar</span>,</span>
<span>            estvar.filter <span class="op">=</span> <span class="va">estvar.filter</span>,</span>
<span>            table_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>row.FIAname <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                              col.FIAname <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>            <span class="op">)</span></span>
<span></span>
<span><span class="co">## Get estimate from EVALIDator API</span></span>
<span><span class="va">APIest</span> <span class="op">&lt;-</span> <span class="fu">getAPIest</span><span class="op">(</span>evalid <span class="op">=</span> <span class="va">evalidVOL</span>,</span>
<span>                    landarea <span class="op">=</span> <span class="va">landarea</span>,</span>
<span>                    estvar <span class="op">=</span> <span class="va">estvar</span>,</span>
<span>                    estvar.filter <span class="op">=</span> <span class="va">estvar.filter</span>,</span>
<span>                    rowvar <span class="op">=</span> <span class="va">rowvar</span>,</span>
<span>                    colvar <span class="op">=</span> <span class="va">colvar</span>,</span>
<span>                    EVALIDATOR_POP_ESTIMATE <span class="op">=</span> <span class="va">EVALIDATOR_POP_ESTIMATE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## Compare estimates - Row</span></span>
<span><span class="fu">compareAPI</span><span class="op">(</span>EVALIDatorlst <span class="op">=</span> <span class="va">APIest</span>,</span>
<span>           FIESTAlst <span class="op">=</span> <span class="va">treeest1</span>,</span>
<span>           compareType <span class="op">=</span> <span class="st">"ROW"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; All estimates match</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span></span>
<span><span class="co">## Compare estimates - Column</span></span>
<span><span class="fu">compareAPI</span><span class="op">(</span>EVALIDatorlst <span class="op">=</span> <span class="va">APIest</span>,</span>
<span>           FIESTAlst <span class="op">=</span> <span class="va">treeest1</span>,</span>
<span>           compareType <span class="op">=</span> <span class="st">"COL"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; All estimates match</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span></span>
<span><span class="co">## Compare estimates - Group</span></span>
<span><span class="fu">compareAPI</span><span class="op">(</span>EVALIDatorlst <span class="op">=</span> <span class="va">APIest</span>,</span>
<span>           FIESTAlst <span class="op">=</span> <span class="va">treeest1</span>,</span>
<span>           compareType <span class="op">=</span> <span class="st">"GRP"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; All estimates match</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="example-2-1">Example 2<a class="anchor" aria-label="anchor" href="#example-2-1"></a>
</h3>
<p>574201 - Net sawlog wood volume of sawtimber trees, in board feet
(Scribner rule), on timberland by forest #type and administrative
forest.</p>
<pre><code><span><span class="co">## Set parameters</span></span>
<span><span class="va">landarea</span> <span class="op">=</span> <span class="st">"TIMBERLAND"</span></span>
<span><span class="va">estvar</span> <span class="op">=</span> <span class="st">"VOLBSNET"</span></span>
<span><span class="va">estvar.filter</span> <span class="op">=</span> <span class="st">"STATUSCD == 1"</span></span>
<span><span class="va">rowvar</span> <span class="op">=</span> <span class="st">"FORTYPCD"</span></span>
<span><span class="va">colvar</span> <span class="op">=</span> <span class="st">"ADFORCD"</span></span>
<span></span>
<span><span class="co">## Get estimates using GB module</span></span>
<span><span class="va">treeest2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/modGBtree.html">modGBtree</a></span><span class="op">(</span>GBpopdat <span class="op">=</span> <span class="va">popdatVOL</span>, </span>
<span>            landarea <span class="op">=</span> <span class="va">landarea</span>,</span>
<span>            rowvar <span class="op">=</span> <span class="va">rowvar</span>,</span>
<span>            colvar <span class="op">=</span> <span class="va">colvar</span>,</span>
<span>            estvar <span class="op">=</span> <span class="va">estvar</span>,</span>
<span>            estvar.filter <span class="op">=</span> <span class="va">estvar.filter</span>,</span>
<span>            table_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>row.FIAname <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                              col.FIAname <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>            <span class="op">)</span></span>
<span></span>
<span><span class="co">## Get estimate from EVALIDator API</span></span>
<span><span class="va">APIest</span> <span class="op">&lt;-</span> <span class="fu">getAPIest</span><span class="op">(</span>evalid <span class="op">=</span> <span class="va">evalidVOL</span>,</span>
<span>                    landarea <span class="op">=</span> <span class="va">landarea</span>,</span>
<span>                    estvar <span class="op">=</span> <span class="va">estvar</span>,</span>
<span>                    estvar.filter <span class="op">=</span> <span class="va">estvar.filter</span>,</span>
<span>                    rowvar <span class="op">=</span> <span class="va">rowvar</span>,</span>
<span>                    colvar <span class="op">=</span> <span class="va">colvar</span>,</span>
<span>                    EVALIDATOR_POP_ESTIMATE <span class="op">=</span> <span class="va">EVALIDATOR_POP_ESTIMATE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## Compare estimates - Row</span></span>
<span><span class="fu">compareAPI</span><span class="op">(</span>EVALIDatorlst <span class="op">=</span> <span class="va">APIest</span>,</span>
<span>           FIESTAlst <span class="op">=</span> <span class="va">treeest2</span>,</span>
<span>           compareType <span class="op">=</span> <span class="st">"ROW"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; All estimates match</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span></span>
<span><span class="co">## Compare estimates - Column</span></span>
<span><span class="fu">compareAPI</span><span class="op">(</span>EVALIDatorlst <span class="op">=</span> <span class="va">APIest</span>,</span>
<span>           FIESTAlst <span class="op">=</span> <span class="va">treeest2</span>,</span>
<span>           compareType <span class="op">=</span> <span class="st">"COL"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; All estimates match</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span></span>
<span><span class="co">## Compare estimates - Group</span></span>
<span><span class="fu">compareAPI</span><span class="op">(</span>EVALIDatorlst <span class="op">=</span> <span class="va">APIest</span>,</span>
<span>           FIESTAlst <span class="op">=</span> <span class="va">treeest2</span>,</span>
<span>           compareType <span class="op">=</span> <span class="st">"GRP"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; All estimates match</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="tree-ratio-estimates">Tree Ratio Estimates<a class="anchor" aria-label="anchor" href="#tree-ratio-estimates"></a>
</h2>
<div class="section level3">
<h3 id="example-1-2">Example 1<a class="anchor" aria-label="anchor" href="#example-1-2"></a>
</h3>
<p>0010 Aboveground biomass of live trees (at least 1 inch
d.b.h./d.r.c.), in dry short tons, on forest land by species group and
tree class.</p>
<pre><code><span><span class="co">## Set parameters</span></span>
<span><span class="va">landarea</span> <span class="op">=</span> <span class="st">"FOREST"</span></span>
<span><span class="va">estvar</span> <span class="op">=</span> <span class="st">"DRYBIO_AG"</span></span>
<span><span class="va">estvar.filter</span> <span class="op">=</span> <span class="st">"STATUSCD == 1"</span></span>
<span><span class="va">rowvar</span> <span class="op">=</span> <span class="st">"FORTYPCD"</span></span>
<span><span class="va">colvar</span> <span class="op">=</span> <span class="st">"STDSZCD"</span></span>
<span><span class="va">strFilter</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="co">## Get estimates using GB module</span></span>
<span><span class="va">ratest1</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/modGBratio.html">modGBratio</a></span><span class="op">(</span>GBpopdat <span class="op">=</span> <span class="va">popdatVOL</span>, </span>
<span>             landarea <span class="op">=</span> <span class="va">landarea</span>,</span>
<span>             rowvar <span class="op">=</span> <span class="va">rowvar</span>,</span>
<span>             colvar <span class="op">=</span> <span class="va">colvar</span>,</span>
<span>             estvarn <span class="op">=</span> <span class="va">estvar</span>,</span>
<span>             estvarn.filter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">estvar.filter</span><span class="op">)</span>,</span>
<span>             table_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>row.FIAname <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                              col.FIAname <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>             <span class="op">)</span></span>
<span></span>
<span><span class="co">## Get estimate from EVALIDator API</span></span>
<span><span class="va">APIest</span> <span class="op">&lt;-</span> <span class="fu">getAPIest</span><span class="op">(</span>evalid <span class="op">=</span> <span class="va">evalidVOL</span>,</span>
<span>                    landarea <span class="op">=</span> <span class="va">landarea</span>,</span>
<span>                    estvar <span class="op">=</span> <span class="va">estvar</span>,</span>
<span>                    estvar.filter <span class="op">=</span> <span class="va">estvar.filter</span>,</span>
<span>                    rowvar <span class="op">=</span> <span class="va">rowvar</span>,</span>
<span>                    colvar <span class="op">=</span> <span class="va">colvar</span>,</span>
<span>                    ratio <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    strFilter <span class="op">=</span> <span class="va">strFilter</span>,</span>
<span>                    EVALIDATOR_POP_ESTIMATE <span class="op">=</span> <span class="va">EVALIDATOR_POP_ESTIMATE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Compare estimates - Row</span></span>
<span><span class="fu">compareAPI</span><span class="op">(</span>EVALIDatorlst <span class="op">=</span> <span class="va">APIest</span>,</span>
<span>           FIESTAlst <span class="op">=</span> <span class="va">ratest1</span>,</span>
<span>           compareType <span class="op">=</span> <span class="st">"ROW"</span><span class="op">)</span></span>
<span><span class="co">#&gt; number of rows are not equal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; All estimates match</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span></span>
<span><span class="co">## Compare estimates - Column</span></span>
<span><span class="fu">compareAPI</span><span class="op">(</span>EVALIDatorlst <span class="op">=</span> <span class="va">APIest</span>,</span>
<span>           FIESTAlst <span class="op">=</span> <span class="va">ratest1</span>,</span>
<span>           compareType <span class="op">=</span> <span class="st">"COL"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; All estimates match</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span></span>
<span><span class="co">## Compare estimates - Group</span></span>
<span><span class="fu">compareAPI</span><span class="op">(</span>EVALIDatorlst <span class="op">=</span> <span class="va">APIest</span>,</span>
<span>           FIESTAlst <span class="op">=</span> <span class="va">ratest1</span>,</span>
<span>           compareType <span class="op">=</span> <span class="st">"GRP"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; All estimates match</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tracey Frescino, Gretchen Moisen, Paul Patterson, Chris Toney, Grayson White, Joshua Yamamoto.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
