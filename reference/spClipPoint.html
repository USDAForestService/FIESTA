<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Spatial - Clip (intersect) point vector layer with polygon vector layer. — spClipPoint • FIESTA</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Spatial - Clip (intersect) point vector layer with polygon vector layer. — spClipPoint"><meta name="description" content="Wrapper for sf::st_intersection, to clip (intersect) point vector layer with
a polygon vector layer."><meta property="og:description" content="Wrapper for sf::st_intersection, to clip (intersect) point vector layer with
a polygon vector layer."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FIESTA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.7.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/FIESTA_tutorial_GB.html">Green-book Estimators</a></li>
    <li><a class="dropdown-item" href="../articles/FIESTA_tutorial_MA.html">Model-Assisted Estimators</a></li>
    <li><a class="dropdown-item" href="../articles/FIESTA_tutorial_SA.html">Small Area Estimators</a></li>
    <li><a class="dropdown-item" href="../articles/FIESTA_tutorial_PB.html">Photo-Based Estimators</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/USDAForestService/FIESTA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Spatial - Clip (intersect) point vector layer with polygon vector layer.</h1>
      <small class="dont-index">Source: <a href="https://github.com/USDAForestService/FIESTA/blob/master/R/spClipPoint.R" class="external-link"><code>R/spClipPoint.R</code></a></small>
      <div class="d-none name"><code>spClipPoint.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Wrapper for sf::st_intersection, to clip (intersect) point vector layer with
a polygon vector layer.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spClipPoint</span><span class="op">(</span></span>
<span>  <span class="va">xyplt</span>,</span>
<span>  xyplt_dsn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  uniqueid <span class="op">=</span> <span class="st">"PLT_CN"</span>,</span>
<span>  <span class="va">clippolyv</span>,</span>
<span>  clippolyv_dsn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  clippolyv.filter <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  buffdist <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  validate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  showext <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  keepNA <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  returnsp <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  othertabnms <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stopifnotin <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  savedata <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  exportsp <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  spMakeSpatial_opts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  savedata_opts <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-xyplt">xyplt<a class="anchor" aria-label="anchor" href="#arg-xyplt"></a></dt>
<dd><p>sf R object or String. Point data to clip. Can be a spatial
points object, full pathname to a shapefile, or name of a layer within a
database.</p></dd>


<dt id="arg-xyplt-dsn">xyplt_dsn<a class="anchor" aria-label="anchor" href="#arg-xyplt-dsn"></a></dt>
<dd><p>String. Data source name (dsn; e.g., sqlite or shapefile
pathname) of layer to clip. The dsn varies by driver. See gdal OGR vector
formats (https://www.gdal.org/ogr_formats.html).</p></dd>


<dt id="arg-uniqueid">uniqueid<a class="anchor" aria-label="anchor" href="#arg-uniqueid"></a></dt>
<dd><p>String.* Unique identifier of xyplt rows.</p></dd>


<dt id="arg-clippolyv">clippolyv<a class="anchor" aria-label="anchor" href="#arg-clippolyv"></a></dt>
<dd><p>sf R object or String. Name of clipping polygon spatial
polygon object, full path to shapefile, or name of a layer within a
database.</p></dd>


<dt id="arg-clippolyv-dsn">clippolyv_dsn<a class="anchor" aria-label="anchor" href="#arg-clippolyv-dsn"></a></dt>
<dd><p>String. Data source name (dsn; e.g., sqlite or
shapefile pathname) of clipping polygon. The dsn varies by driver. See gdal
OGR vector formats (https://www.gdal.org/ogr_formats.html).</p></dd>


<dt id="arg-clippolyv-filter">clippolyv.filter<a class="anchor" aria-label="anchor" href="#arg-clippolyv-filter"></a></dt>
<dd><p>String. Filter to subset clippolyv spatial layer.</p></dd>


<dt id="arg-buffdist">buffdist<a class="anchor" aria-label="anchor" href="#arg-buffdist"></a></dt>
<dd><p>Number. The distance to buffer the polygon before clipping.
Uses sf::st_buffer. The distance is based on units of polygon, st_crs(x)$units.</p></dd>


<dt id="arg-validate">validate<a class="anchor" aria-label="anchor" href="#arg-validate"></a></dt>
<dd><p>Logical. If TRUE, validates polyv and clippolyv before
clipping. Uses sf::st_make_valid with default parameters
(geos_method='valid_structure', geos_keep_collapsed=FALSE).</p></dd>


<dt id="arg-showext">showext<a class="anchor" aria-label="anchor" href="#arg-showext"></a></dt>
<dd><p>Logical. If TRUE, layer extents are displayed in plot window.</p></dd>


<dt id="arg-keepna">keepNA<a class="anchor" aria-label="anchor" href="#arg-keepna"></a></dt>
<dd><p>Logical. If TRUE, keep NA values after data intersection.</p></dd>


<dt id="arg-returnsp">returnsp<a class="anchor" aria-label="anchor" href="#arg-returnsp"></a></dt>
<dd><p>Logical. If TRUE, returns sf object of points. If FALSE,
returns data frame of points (i.e., drops sf geometry).</p></dd>


<dt id="arg-othertabnms">othertabnms<a class="anchor" aria-label="anchor" href="#arg-othertabnms"></a></dt>
<dd><p>String vector. Name(s) of R objects, comma-delimited
files, or database layers to subset. Must include quotes (e.g.,
othertabnms=c("tree", "cond")).</p></dd>


<dt id="arg-stopifnotin">stopifnotin<a class="anchor" aria-label="anchor" href="#arg-stopifnotin"></a></dt>
<dd><p>Logical. If TRUE, stops if boundaries do not overlap.  If
FALSE, returns NULL.</p></dd>


<dt id="arg-savedata">savedata<a class="anchor" aria-label="anchor" href="#arg-savedata"></a></dt>
<dd><p>Logical. If TRUE, save data to outfolder.</p></dd>


<dt id="arg-exportsp">exportsp<a class="anchor" aria-label="anchor" href="#arg-exportsp"></a></dt>
<dd><p>Logical. If TRUE, the clipped spatial point data are
exported.</p></dd>


<dt id="arg-spmakespatial-opts">spMakeSpatial_opts<a class="anchor" aria-label="anchor" href="#arg-spmakespatial-opts"></a></dt>
<dd><p>List. See help(spMakeSpatial_options()) for a list
of options. Use to convert X/Y values to simple feature (sf) coordinates.</p></dd>


<dt id="arg-savedata-opts">savedata_opts<a class="anchor" aria-label="anchor" href="#arg-savedata-opts"></a></dt>
<dd><p>List. See help(savedata_options()) for a list
of options for saving data. If out_layer = NULL, default = 'pntclip'.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of the following objects:</p>
<dl><dt>clip_xyplt</dt>
<dd><p>sf object. The input xyplt, clipped to polygon boundary
layer.  The projection will be same as clippolyv projection.</p></dd>

<dt>xy.uniqueid</dt>
<dd><p>String. Unique identifier of clip_xy.</p></dd>

<dt>clip_polyv</dt>
<dd><p>SpatialPolygonsDataFrame. The polygon boundary layer used
for clipping.</p></dd>
 <dt>clip_tabs</dt>
<dd><p>Data frame(s). Other tables in intabs
clipped to boundary.</p></dd>


</dl><p>If exportsp=TRUE, the sf object will be written to out_dsn (See note).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The sf::st_intersection function is used to clip points. <br></p>
<p>If the projection of clippolyv is not the same as the xyplt, the xyplt layer
layer will be reprojected to the same projection as the clippoly before
intersection.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>On-the-fly projection conversion<br> The spTransform (sf) method is
used for on-the-fly map projection conversion and datum transformation using
PROJ.4 arguments. Datum transformation only occurs if the +datum tag is
present in the both the from and to PROJ.4 strings. The +towgs84 tag is used
when no datum transformation is needed. PROJ.4 transformations assume NAD83
and WGS84 are identical unless other transformation parameters are
specified.  Be aware, providing inaccurate or incomplete CRS information may
lead to erroneous data shifts when reprojecting. See spTransform help
documentation for more details.</p>
<p>ESRI Shapefile Driver<br> If exportsp=TRUE:<br> The st_write (sf) function
is called. If out_fmt="shp", the ESRI Shapefile driver truncates variable
names to 10 characters or less. Variable names are changed before export
using an internal function (trunc10shp). If sf object has more than 1
record, it will be returned but not exported.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Tracey S. Frescino</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Get point data from WYplt data in FIESTA</span></span></span>
<span class="r-in"><span><span class="va">WYplt</span> <span class="op">&lt;-</span> <span class="fu">FIESTA</span><span class="fu">::</span><span class="va"><a href="WYplt.html">WYplt</a></span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get polygon vector layer from FIESTA external data</span></span></span>
<span class="r-in"><span><span class="va">WYbhdistfn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span></span>
<span class="r-in"><span>                          <span class="st">"sp_data/WYbighorn_districtbnd.shp"</span>,</span></span>
<span class="r-in"><span>                          package <span class="op">=</span> <span class="st">"FIESTA"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract points from polygon vector layer</span></span></span>
<span class="r-in"><span><span class="va">xyext</span> <span class="op">&lt;-</span> <span class="fu">spClipPoint</span><span class="op">(</span>xyplt <span class="op">=</span> <span class="va">WYplt</span>,</span></span>
<span class="r-in"><span>                     clippolyv <span class="op">=</span> <span class="va">WYbhdistfn</span>,</span></span>
<span class="r-in"><span>                     clippolyv.filter <span class="op">=</span> <span class="st">"DISTRICTNU == '03'"</span>,</span></span>
<span class="r-in"><span>                     uniqueid <span class="op">=</span> <span class="st">"CN"</span>,</span></span>
<span class="r-in"><span>                     spMakeSpatial_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>xvar <span class="op">=</span> <span class="st">"LON_PUBLIC"</span>,</span></span>
<span class="r-in"><span>                                               yvar <span class="op">=</span> <span class="st">"LAT_PUBLIC"</span>,</span></span>
<span class="r-in"><span>                                               xy.crs <span class="op">=</span> <span class="fl">4269</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> filter removed 2 records: DISTRICTNU == '03'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> crs.default must be in a projected CRS... using US albers</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> +proj=aea +lat_0=23 +lon_0=-96 +lat_1=29.5 +lat_2=45.5 +x_0=0 +y_0=0 +datum=NAD83 +units=m +no_defs +type=crs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> reprojecting layer... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  from: EPSG:4269 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  to: +proj=aea +lat_0=23 +lon_0=-96 +lat_1=29.5 +lat_2=45.5 +x_0=0 +y_0=0 +datum=NAD83 +units=m +no_defs +type=crs</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">xyext</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "clip_xyplt" "uniqueid"   "clip_polyv"</span>
<span class="r-in"><span><span class="va">xyplt</span> <span class="op">&lt;-</span> <span class="va">xyext</span><span class="op">$</span><span class="va">clip_xyplt</span></span></span>
<span class="r-in"><span><span class="va">polyv</span> <span class="op">&lt;-</span> <span class="va">xyext</span><span class="op">$</span><span class="va">clip_polyv</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot extracted values of national forest district</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">polyv</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">xyplt</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="spClipPoint-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tracey Frescino, Gretchen Moisen, Paul Patterson, Chris Toney, Grayson White, Joshua Yamamoto.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

