<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Spatial - Extracts summary statistics by polygon (i.e., zone) for a raster. — spZonalRast • FIESTA</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Spatial - Extracts summary statistics by polygon (i.e., zone) for a raster. — spZonalRast"><meta name="description" content="Extracts summary statistics by polygon, or zone for a raster (single or
multi-band)."><meta property="og:description" content="Extracts summary statistics by polygon, or zone for a raster (single or
multi-band)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FIESTA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.6.4.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/FIESTA_tutorial_GB.html">Green-book Estimators</a></li>
    <li><a class="dropdown-item" href="../articles/FIESTA_tutorial_MA.html">Model-Assisted Estimators</a></li>
    <li><a class="dropdown-item" href="../articles/FIESTA_tutorial_SA.html">Small Area Estimators</a></li>
    <li><a class="dropdown-item" href="../articles/FIESTA_tutorial_PB.html">Photo-Based Estimators</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/USDAForestService/FIESTA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Spatial - Extracts summary statistics by polygon (i.e., zone) for a raster.</h1>
      <small class="dont-index">Source: <a href="https://github.com/USDAForestService/FIESTA/blob/master/R/spZonalRast.R" class="external-link"><code>R/spZonalRast.R</code></a></small>
      <div class="d-none name"><code>spZonalRast.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Extracts summary statistics by polygon, or zone for a raster (single or
multi-band).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spZonalRast</span><span class="op">(</span></span>
<span>  <span class="va">polyv</span>,</span>
<span>  polyv_dsn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  polyv.att <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">rastfn</span>,</span>
<span>  rastfolder <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bands <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">zonalstat</span>,</span>
<span>  pixelfun <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  validate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  outname <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  showext <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  rastlut <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rast.NODATA <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  savedata <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  savedata_opts <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-polyv">polyv<a class="anchor" aria-label="anchor" href="#arg-polyv"></a></dt>
<dd><p>sf R object or String. Polygon data to identify zones. Can be a
spatial polygon object, full pathname to a shapefile, or name of a layer
within a database.</p></dd>


<dt id="arg-polyv-dsn">polyv_dsn<a class="anchor" aria-label="anchor" href="#arg-polyv-dsn"></a></dt>
<dd><p>String. Data source name (dsn; e.g., sqlite or shapefile
pathname) of zonal layer. The dsn varies by driver. See gdal OGR vector
formats (https://www.gdal.org/ogr_formats.html). Optional if polyv is sf
object.</p></dd>


<dt id="arg-polyv-att">polyv.att<a class="anchor" aria-label="anchor" href="#arg-polyv-att"></a></dt>
<dd><p>String. Name of attribute in polyv to identify zones for
summarizing raster statistics.</p></dd>


<dt id="arg-rastfn">rastfn<a class="anchor" aria-label="anchor" href="#arg-rastfn"></a></dt>
<dd><p>String or Raster. File name with extension, or raster
object.  Note: raster objects must be written to file.</p></dd>


<dt id="arg-rastfolder">rastfolder<a class="anchor" aria-label="anchor" href="#arg-rastfolder"></a></dt>
<dd><p>String. Name of the folder with raster layers. Optional.
Useful if all raster layers are in same folder.</p></dd>


<dt id="arg-bands">bands<a class="anchor" aria-label="anchor" href="#arg-bands"></a></dt>
<dd><p>Numeric vector. If rast is a multi-layer raster and only 1 or
some layers are desired, specify layer number(s) in a vector format. If
NULL, all layers are summed.</p></dd>


<dt id="arg-zonalstat">zonalstat<a class="anchor" aria-label="anchor" href="#arg-zonalstat"></a></dt>
<dd><p>String vector. Zonal statistic(s) to return for rasters
with continuous data ("mean", "sum", "majority", "minority", "variety",
"npixels") or rasters with discrete data ("count", "proportion").</p></dd>


<dt id="arg-pixelfun">pixelfun<a class="anchor" aria-label="anchor" href="#arg-pixelfun"></a></dt>
<dd><p>Function. A function to apply to the individual pixel values
before calculating sum and mean. The function should accept a single numeric
argument (pixel value) and return a single numeric argument.</p></dd>


<dt id="arg-validate">validate<a class="anchor" aria-label="anchor" href="#arg-validate"></a></dt>
<dd><p>Logical. If TRUE, validates polyv and clippolyv before
clipping. Uses sf::st_make_valid with default parameters
(geos_method='valid_structure', geos_keep_collapsed=FALSE).</p></dd>


<dt id="arg-outname">outname<a class="anchor" aria-label="anchor" href="#arg-outname"></a></dt>
<dd><p>String. Variable name for output. The output names will use
outname as a prefix to summary statistics (i.e., 'outname'.mean,
'outname'.sum).</p></dd>


<dt id="arg-showext">showext<a class="anchor" aria-label="anchor" href="#arg-showext"></a></dt>
<dd><p>Logical. If TRUE, layer extents are displayed in plot window.</p></dd>


<dt id="arg-rastlut">rastlut<a class="anchor" aria-label="anchor" href="#arg-rastlut"></a></dt>
<dd><p>Data frame. A look up table to recode raster values. Must be
2 columns: Column 1 with raster values and column 2 with recode values.</p></dd>


<dt id="arg-rast-nodata">rast.NODATA<a class="anchor" aria-label="anchor" href="#arg-rast-nodata"></a></dt>
<dd><p>Numeric. NODATA value (if not already defined) or other
values to ignore. These values will be removed from output zonal table.
NODATA values defined in raster are removed before zonal statistic
calculations.</p></dd>


<dt id="arg-savedata">savedata<a class="anchor" aria-label="anchor" href="#arg-savedata"></a></dt>
<dd><p>Logical. If TRUE, the zonal data are saved to outfolder.</p></dd>


<dt id="arg-savedata-opts">savedata_opts<a class="anchor" aria-label="anchor" href="#arg-savedata-opts"></a></dt>
<dd><p>List. See help(savedata_options()) for a list
of options. Only used when savedata = TRUE. If out_layer = NULL,
default = 'zonalext'.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>


<dl><dt>zonalext</dt>
<dd><p>Data frame. Zonal statistics by polygon attribute
(attribute).</p></dd>
 <dt>outname</dt>
<dd><p>String vector. Names of zonal statistic
variables generated in zonalext data frame.</p></dd>
 <dt>rasterfile</dt>
<dd><p>String
vector. Names of raster file(s) associated with zonal statistic.</p></dd>


</dl><p>If savedata=TRUE, outdat data frame is saved to outfolder (Default name:
zonalext_'date'.csv).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Use spZonalRast() to prompt for input.</p>
<p>If the projection of polyv is different than the projection of rast, the
polyv SpatialPolygons object is converted to the projection of rast (See
note about on-the-fly projection conversion).</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>rast.NODATA<br> NODATA values are raster pixel values that have no data
of interest, including pixels within the extent of the layer, but outside
the area of interest. Sometimes these pixels have been defined previously.
The defined NODATA pixels are imported to R as NULL values. When not
previously defined, the pixels outside the area of interest will be the
minimum or maximum value depending on the data type (e.g., 16-bit signed:
min=-32,768; max=32,768) or byte size (1 byte: min=0; max=255).  These
NODATA values will be added to the zonal statistic calculations if not
specified in rast.NODATA.</p>
<p>On-the-fly projection conversion<br> The spTransform (sf) method is used
for on-the-fly map projection conversion and datum transformation using
PROJ.4 arguments. Datum transformation only occurs if the +datum tag is
present in the both the from and to PROJ.4 strings. The +towgs84 tag is used
when no datum transformation is needed. PROJ.4 transformations assume NAD83
and WGS84 are identical unless other transformation parameters are
specified.  Be aware, providing inaccurate or incomplete CRS information may
lead to erroneous data shifts when reprojecting. See spTransform help
documentation for more details.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Tracey S. Frescino</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Set up data from `FIESTA`</span></span></span>
<span class="r-in"><span><span class="va">WYbhdistfn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span></span>
<span class="r-in"><span>                          <span class="st">"sp_data/WYbighorn_districtbnd.shp"</span>,</span></span>
<span class="r-in"><span>                          package <span class="op">=</span> <span class="st">"FIESTA"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">demfn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span></span>
<span class="r-in"><span>                     <span class="st">"sp_data/WYbighorn_dem_250m.img"</span>,</span></span>
<span class="r-in"><span>                     package <span class="op">=</span> <span class="st">"FIESTA"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Import spatial data with `spImportSpatial`</span></span></span>
<span class="r-in"><span><span class="va">WYbhdist</span> <span class="op">&lt;-</span> <span class="fu"><a href="spImportSpatial.html">spImportSpatial</a></span><span class="op">(</span><span class="va">WYbhdistfn</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract mean and sum in `WYbhdist`</span></span></span>
<span class="r-in"><span><span class="fu">spZonalRast</span><span class="op">(</span>polyv <span class="op">=</span> <span class="va">WYbhdist</span>, </span></span>
<span class="r-in"><span>            polyv.att <span class="op">=</span> <span class="st">"DISTRICTNA"</span>, </span></span>
<span class="r-in"><span>            rastfn <span class="op">=</span> <span class="va">demfn</span>, </span></span>
<span class="r-in"><span>            zonalstat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"sum"</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> /home/runner/work/_temp/Library/FIESTA/extdata/sp_data/WYbighorn_dem_250m.img</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> reprojecting layer... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  from: NAD83 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  to: PROJCS["North_American_1927_Albers",GEOGCS["NAD27",DATUM["North_American_Datum_1927",SPHEROID["Clarke 1866",6378206.4,294.9786982,AUTHORITY["EPSG","7008"]],AUTHORITY["EPSG","6267"]],PRIMEM["Greenwich",0],UNIT["Degree",0.0174532925199433]],PROJECTION["Albers_Conic_Equal_Area"],PARAMETER["latitude_of_center",23],PARAMETER["longitude_of_center",-96],PARAMETER["standard_parallel_1",29.5],PARAMETER["standard_parallel_2",45.5],PARAMETER["false_easting",0],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $zonalext</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       DISTRICTNA WYbighorn_dem_250m.mean WYbighorn_dem_250m.sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Medicine Wheel Ranger District                2650.793               62603774</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Powder River Ranger District                2686.069               58150700</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         Tongue Ranger District                2538.865               67965407</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $outname</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "WYbighorn_dem_250m.mean" "WYbighorn_dem_250m.sum" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rasterfile</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/home/runner/work/_temp/Library/FIESTA/extdata/sp_data/WYbighorn_dem_250m.img"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "/home/runner/work/_temp/Library/FIESTA/extdata/sp_data/WYbighorn_dem_250m.img"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tracey Frescino, Gretchen Moisen, Paul Patterson, Chris Toney, Grayson White, Joshua Yamamoto.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

