<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Spatial wrapper - Extracts XY coordinates within a given boundary. — spGetXY • FIESTA</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Spatial wrapper - Extracts XY coordinates within a given boundary. — spGetXY"><meta property="og:description" content="Wrapper to get FIA plots within the boundary population (area of interest) -
Intersect with state boundary - Get FIA plots for intersected states,
including tree, and spatial - Clip spatial coordinates and other tables to
boundary (spClipPoint)"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FIESTA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.5.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/FIESTA_manual_mod_est.html">`FIESTA` Manual - Module Estimates</a>
    </li>
    <li>
      <a href="../articles/FIESTA_manual_mod_pop.html">`FIESTA` Manual - Population Data</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_DB.html">FIESTA - Database Tools</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_GB.html">FIESTA - Green-book Estimators</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_MA.html">FIESTA - Model-Assisted Estimators</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_PB.html">FIESTA - Photo-Based Module</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_SA.html">FIESTA - Small Area Estimators</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_dat.html">FIESTA - Data Tools</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_sp.html">FIESTA - Spatial Tools</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Spatial wrapper - Extracts XY coordinates within a given boundary.</h1>
    
    <div class="hidden name"><code>spGetXY.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Wrapper to get FIA plots within the boundary population (area of interest) -
Intersect with state boundary - Get FIA plots for intersected states,
including tree, and spatial - Clip spatial coordinates and other tables to
boundary (spClipPoint)</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spGetXY</span><span class="op">(</span></span>
<span>  <span class="va">bnd</span>,</span>
<span>  bnd_dsn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bnd.filter <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  states <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  RS <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xy_datsource <span class="op">=</span> <span class="st">"datamart"</span>,</span>
<span>  xy_dsn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xy <span class="op">=</span> <span class="st">"PLOT"</span>,</span>
<span>  xy_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/FIESTAutils/man/xy_options.html" class="external-link">xy_options</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  datsource <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data_dsn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dbTabs <span class="op">=</span> <span class="fu"><a href="dbTables.html">dbTables</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  eval <span class="op">=</span> <span class="st">"FIA"</span>,</span>
<span>  eval_opts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pjoinid <span class="op">=</span> <span class="st">"CN"</span>,</span>
<span>  invtype <span class="op">=</span> <span class="st">"ANNUAL"</span>,</span>
<span>  intensity1 <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pvars2keep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  clipxy <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  showsteps <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  returnxy <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  savedata <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  exportsp <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  savedata_opts <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>bnd</dt>
<dd><p>sf R object, Area of Interest (AOI) boundary. Can be a spatial sf
object, full pathname to a shapefile, or name of a layer within a database.</p></dd>


<dt>bnd_dsn</dt>
<dd><p>String. Data source name (dsn; e.g., SQLite database or shapefile
pathname) of bnd. The dsn varies by driver. See gdal OGR vector formats
(https://www.gdal.org/ogr_formats.html). Optional if bnd is an R object.</p></dd>


<dt>bnd.filter</dt>
<dd><p>String. Filter to subset bnd spatial layer.</p></dd>


<dt>states</dt>
<dd><p>String. The name of state(s) for tables (e.g., "Vermont",
"Utah").</p></dd>


<dt>RS</dt>
<dd><p>String. Name of FIA research station to restrict states to
('RMRS','SRS','NCRS','NERS','PNWRS'). If NULL, all research stations are
included.</p></dd>


<dt>xy_datsource</dt>
<dd><p>Source of XY data ('datamart', 'sqlite', 'obj', 'csv').</p></dd>


<dt>xy_dsn</dt>
<dd><p>If datsource='sqlite', the file name (data source name) of
the sqlite database (*.db) where XY data reside.</p></dd>


<dt>xy</dt>
<dd><p>sf R object or String. If xy_dsn = 'datamart', name of xy table 
in FIA DataMart. If xy_dsn = 'sqlite', name of xy layer in database. If 
datsource = 'csv', full pathname of xy CSV file(s). If datsource = 'obj', 
name of xy R object. If datsource = 'shp', full pathname of shapefile.</p></dd>


<dt>xy_opts</dt>
<dd><p>List of xy data options for xy (e.g., xy_opts = list(xvar='LON', 
yvar='LAT'). See xy_options() for more options and defaults.</p></dd>


<dt>datsource</dt>
<dd><p>String. Source of FIA data for defining FIA evalutions or 
appending variables ('datamart', 'sqlite', 'obj', 'csv'). If datsource = NULL, 
datsource = xy_datsource. If datsource = 'datamart', data are downloaded
extracted from FIA DataMart (http://apps.fs.usda.gov/fia/datamart/datamart.html). 
If datsource='sqlite', specify database name(s) in data_dsn and table name(s) 
in dbTabs() argument. If datsource = ('obj','csv'), specify *.csv file name in 
dbTabs argument.</p></dd>


<dt>data_dsn</dt>
<dd><p>String. Name of database with plot_layer and/or ppsa_layer.</p></dd>


<dt>dbTabs</dt>
<dd><p>String or R Object. If data_dsn = 'datamart', name of table(s) 
in FIA DataMart. If data_dsn = 'sqlite', name of layer(s) in database. If 
datsource = 'csv', name of CSV file(s). If datsource = 'obj', name of R object.</p></dd>


<dt>eval</dt>
<dd><p>String. Type of evaluation time frame for data extraction 
('FIA', 'custom'). See eval_opts for more further options.</p></dd>


<dt>eval_opts</dt>
<dd><p>List of evaluation options for 'FIA' or 'custom'
evaluations to determine the set of data returned. See help(eval_options)
for a list of options.</p></dd>


<dt>pjoinid</dt>
<dd><p>String. Variable in plt to join to XY data. Not necessary to
be unique. If using most current XY coordinates, use identifier for a plot
(e.g., PLOT_ID).</p></dd>


<dt>invtype</dt>
<dd><p>String. Type of FIA inventory to extract ('PERIODIC',
'ANNUAL').  Only one inventory type (PERIODIC/ANNUAL) at a time.</p></dd>


<dt>intensity1</dt>
<dd><p>Logical. If TRUE, includes only XY coordinates where 
INTENSITY = 1 (FIA base grid).</p></dd>


<dt>pvars2keep</dt>
<dd><p>String vector. One or more variables in pltTab to append to output.</p></dd>


<dt>clipxy</dt>
<dd><p>Logical. If TRUE, clips xy data to bnd.</p></dd>


<dt>showsteps</dt>
<dd><p>Logical. If TRUE, display data in device window.</p></dd>


<dt>returnxy</dt>
<dd><p>Logical. If TRUE, returns XY coordinates.</p></dd>


<dt>savedata</dt>
<dd><p>Logical. If TRUE, saves data to outfolder. Note:
includes XY data if returnxy = TRUE.</p></dd>


<dt>exportsp</dt>
<dd><p>Logical. If savedata = TRUE and returnxy = TRUE, 
if TRUE, exports XY data as spatial data.</p></dd>


<dt>savedata_opts</dt>
<dd><p>List. See help(savedata_options()) for a list
of options. Only used when savedata = TRUE.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <dl><dt>spxy</dt>
<dd><p>sf. If returnxy=TRUE, spatial xy point data.</p></dd>

<dt>pltids</dt>
<dd><p>data frame. A table of pltids that are within bnd.</p></dd>

<dt>spxy</dt>
<dd><p>sf data frame. If returnxy, a simple feature with pltids within bnd.</p></dd>

<dt>bndx</dt>
<dd><p>sf object. Input bnd.</p></dd>
 
<dt>xy.uniqueid</dt>
<dd><p>String. Unique identifier of plots in xy.</p></dd>
 
<dt>states</dt>
<dd><p>String. Vector of states that intersect bnd.</p></dd>
 
<dt>countyfips</dt>
<dd><p>String. Vector of countyfips values that intersect bnd.</p></dd>
 
<dt>stbnd.att</dt>
<dd><p>String. Name of state attribute used to select plots.</p></dd>


</dl><p>If savedata=TRUE and returnxy=TRUE, the plt data frame, including XY 
coordinates is saved to outfolder (xyplt).<br></p>
 

<p>If savedata=TRUE and returnxy=FALSE, the plt data frame, without XY 
coordinates is saved to outfolder (pltids).<br></p>


<p>If savedata=TRUE and returnxy=TRUE and exportsp=TRUE, the spxy sf object is 
exported as shapefile to outfolder.<br></p>


    </div>
    <div id="details">
    <h2>Details</h2>
    <p><b>datsource</b></p>
<p>Plots are extracted from 3 different data sources:<br> 1) CSV - data have
previously been extracted from the FIA database and stored as CSV files.<br>
2) datamart - data are extracted from FIA's publically-available
datamart.<br> 3) sqlite - data have previously been extracted from the FIA
database and stored within a SQLite database.<br></p>
<p><b>Selection parameters</b></p>
<p>FIA plots are selected based on the following parameters:<br></p><table class="table table"><tr><td></td><td>evalid - the FIA evaluation identifier</td></tr><tr><td></td><td>evalCur - the most
current FIA evaluation in database</td></tr><tr><td></td><td>evalEndyr - the FIA evaluation
ending in evalEndyr</td></tr><tr><td></td><td>evalType - the FIA evaluation type ('ALL',
'AREAVOL', 'GRM', 'P2VEG', 'DWM', 'INV', 'REGEN', 'CRWN')</td></tr><tr><td></td><td>measCur -
the most current measurement of each plot in database</td></tr><tr><td></td><td>measEndyr -
the most current measuremtn of each plot in database in or prior to
measEndyr</td></tr><tr><td></td><td>Endyr.filter - a filter for bnd that specifies the
boundary where measEndyr should be applied</td></tr></table></div>
    <div id="note">
    <h2>Note</h2>
    <p>If savebnd=TRUE:<br> If out_fmt=c('csv','shp'), the writeOGR (rgdal) function
is called. The ArcGIS driver truncates variable names to 10 characters or
less. Variable names are changed before export using an internal function
(trunc10shp). If Spatial object has more than 1 record, it will be returned
but not exported.</p>
<p>If datsource="datmart", (default), data are imported from FIA DataMart.  The
plot coordinates have been altered for privacy (See
https://www.fia.fs.fed.us/tools-data/spatial/Policy/index.php for details).
The zip files are extracted on-the-fly from the online website. Web server
connections will affect download speeds.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Tracey S. Frescino</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># Set up data from FIESTA</span></span></span>
<span class="r-in"><span><span class="va">WYbhfn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span></span>
<span class="r-in"><span>                      <span class="st">"sp_data/WYbighorn_adminbnd.shp"</span>,</span></span>
<span class="r-in"><span>                      package <span class="op">=</span> <span class="st">"FIESTA"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Use spGetXY</span></span></span>
<span class="r-in"><span><span class="va">WYbhxy</span> <span class="op">&lt;-</span> <span class="fu">spGetXY</span><span class="op">(</span>bnd <span class="op">=</span> <span class="va">WYbhfn</span>,</span></span>
<span class="r-in"><span>                  xy_datsource <span class="op">=</span> <span class="st">"datamart"</span>,</span></span>
<span class="r-in"><span>                  eval <span class="op">=</span> <span class="st">"custom"</span>,</span></span>
<span class="r-in"><span>                  eval_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Cur <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  returnxy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Tracey Frescino, Gretchen Moisen, Paul Patterson, Chris Toney, Grayson White.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

