<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Spatial - Extracts summary statistics by polygon (i.e., zone) for a raster. — spZonalRast • FIESTA</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Spatial - Extracts summary statistics by polygon (i.e., zone) for a raster. — spZonalRast"><meta property="og:description" content="Extracts summary statistics by polygon, or zone for a raster (single or
multi-band)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FIESTA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.6.4.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/FIESTA_manual_mod_est.html">`FIESTA` Manual - Module Estimates</a>
    </li>
    <li>
      <a href="../articles/FIESTA_manual_mod_pop.html">`FIESTA` Manual - Population Data</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_dat.html">FIESTA - Data Tools</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_DB.html">FIESTA - Database Tools</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_GB.html">FIESTA - Green-book Estimators</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_MA.html">FIESTA - Model-Assisted Estimators</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_PB.html">FIESTA - Photo-Based Module</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_SA.html">FIESTA - Small Area Estimators</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_sp.html">FIESTA - Spatial Tools</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/USDAForestService/FIESTA/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Spatial - Extracts summary statistics by polygon (i.e., zone) for a raster.</h1>
    <small class="dont-index">Source: <a href="https://github.com/USDAForestService/FIESTA/blob/HEAD/R/spZonalRast.R" class="external-link"><code>R/spZonalRast.R</code></a></small>
    <div class="hidden name"><code>spZonalRast.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Extracts summary statistics by polygon, or zone for a raster (single or
multi-band).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spZonalRast</span><span class="op">(</span></span>
<span>  <span class="va">polyv</span>,</span>
<span>  polyv_dsn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  polyv.att <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">rastfn</span>,</span>
<span>  rastfolder <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bands <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">zonalstat</span>,</span>
<span>  pixelfun <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  validate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  outname <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  showext <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  rastlut <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rast.NODATA <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  savedata <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  savedata_opts <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>polyv</dt>
<dd><p>sf R object or String. Polygon data to identify zones. Can be a
spatial polygon object, full pathname to a shapefile, or name of a layer
within a database.</p></dd>


<dt>polyv_dsn</dt>
<dd><p>String. Data source name (dsn; e.g., sqlite or shapefile
pathname) of zonal layer. The dsn varies by driver. See gdal OGR vector
formats (https://www.gdal.org/ogr_formats.html). Optional if polyv is sf
object.</p></dd>


<dt>polyv.att</dt>
<dd><p>String. Name of attribute in polyv to identify zones for
summarizing raster statistics.</p></dd>


<dt>rastfn</dt>
<dd><p>String or Raster. File name with extension, or raster
object.  Note: raster objects must be written to file.</p></dd>


<dt>rastfolder</dt>
<dd><p>String. Name of the folder with raster layers. Optional.
Useful if all raster layers are in same folder.</p></dd>


<dt>bands</dt>
<dd><p>Numeric vector. If rast is a multi-layer raster and only 1 or
some layers are desired, specify layer number(s) in a vector format. If
NULL, all layers are summed.</p></dd>


<dt>zonalstat</dt>
<dd><p>String vector. Zonal statistic(s) to return for rasters
with continuous data ("mean", "sum", "majority", "minority", "variety",
"npixels") or rasters with discrete data ("count", "proportion").</p></dd>


<dt>pixelfun</dt>
<dd><p>Function. A function to apply to the individual pixel values
before calculating sum and mean. The function should accept a single numeric
argument (pixel value) and return a single numeric argument.</p></dd>


<dt>validate</dt>
<dd><p>Logical. If TRUE, validates polyv and clippolyv before 
clipping. Uses sf::st_make_valid with default parameters 
(geos_method='valid_structure', geos_keep_collapsed=FALSE).</p></dd>


<dt>outname</dt>
<dd><p>String. Variable name for output. The output names will use
outname as a prefix to summary statistics (i.e., 'outname'.mean,
'outname'.sum).</p></dd>


<dt>showext</dt>
<dd><p>Logical. If TRUE, layer extents are displayed in plot window.</p></dd>


<dt>rastlut</dt>
<dd><p>Data frame. A look up table to recode raster values. Must be
2 columns: Column 1 with raster values and column 2 with recode values.</p></dd>


<dt>rast.NODATA</dt>
<dd><p>Numeric. NODATA value (if not already defined) or other 
values to ignore. These values will be removed from output zonal table. 
NODATA values defined in raster are removed before zonal statistic 
calculations.</p></dd>


<dt>savedata</dt>
<dd><p>Logical. If TRUE, the zonal data are saved to outfolder.</p></dd>


<dt>savedata_opts</dt>
<dd><p>List. See help(savedata_options()) for a list
of options. Only used when savedata = TRUE. If out_layer = NULL,
default = 'zonalext'.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <dl><dt>zonalext</dt>
<dd><p>Data frame. Zonal statistics by polygon attribute
(attribute).</p></dd>
 <dt>outname</dt>
<dd><p>String vector. Names of zonal statistic
variables generated in zonalext data frame.</p></dd>
 <dt>rasterfile</dt>
<dd><p>String
vector. Names of raster file(s) associated with zonal statistic.</p></dd>


</dl><p>If savedata=TRUE, outdat data frame is saved to outfolder (Default name:
zonalext_'date'.csv).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Use spZonalRast() to prompt for input.</p>
<p>If the projection of polyv is different than the projection of rast, the
polyv SpatialPolygons object is converted to the projection of rast (See
note about on-the-fly projection conversion).</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>rast.NODATA<br> NODATA values are raster pixel values that have no data
of interest, including pixels within the extent of the layer, but outside
the area of interest. Sometimes these pixels have been defined previously.
The defined NODATA pixels are imported to R as NULL values. When not
previously defined, the pixels outside the area of interest will be the
minimum or maximum value depending on the data type (e.g., 16-bit signed:
min=-32,768; max=32,768) or byte size (1 byte: min=0; max=255).  These
NODATA values will be added to the zonal statistic calculations if not
specified in rast.NODATA.</p>
<p>On-the-fly projection conversion<br> The spTransform (sf) method is used
for on-the-fly map projection conversion and datum transformation using
PROJ.4 arguments. Datum transformation only occurs if the +datum tag is
present in the both the from and to PROJ.4 strings. The +towgs84 tag is used
when no datum transformation is needed. PROJ.4 transformations assume NAD83
and WGS84 are identical unless other transformation parameters are
specified.  Be aware, providing inaccurate or incomplete CRS information may
lead to erroneous data shifts when reprojecting. See spTransform help
documentation for more details.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Tracey S. Frescino</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Set up data from `FIESTA`</span></span></span>
<span class="r-in"><span><span class="va">WYbhdistfn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span></span>
<span class="r-in"><span>                          <span class="st">"sp_data/WYbighorn_districtbnd.shp"</span>,</span></span>
<span class="r-in"><span>                          package <span class="op">=</span> <span class="st">"FIESTA"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">demfn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span></span>
<span class="r-in"><span>                     <span class="st">"sp_data/WYbighorn_dem_250m.img"</span>,</span></span>
<span class="r-in"><span>                     package <span class="op">=</span> <span class="st">"FIESTA"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Import spatial data with `spImportSpatial`</span></span></span>
<span class="r-in"><span><span class="va">WYbhdist</span> <span class="op">&lt;-</span> <span class="fu"><a href="spImportSpatial.html">spImportSpatial</a></span><span class="op">(</span><span class="va">WYbhdistfn</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract mean and sum in `WYbhdist`</span></span></span>
<span class="r-in"><span><span class="fu">spZonalRast</span><span class="op">(</span>polyv <span class="op">=</span> <span class="va">WYbhdist</span>, </span></span>
<span class="r-in"><span>            polyv.att <span class="op">=</span> <span class="st">"DISTRICTNA"</span>, </span></span>
<span class="r-in"><span>            rastfn <span class="op">=</span> <span class="va">demfn</span>, </span></span>
<span class="r-in"><span>            zonalstat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"sum"</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> /private/var/folders/kd/4wp69y7d2yd3fxpd1_m64clm0000gn/T/RtmpWUzLtI/temp_libpath10a93f405e55/FIESTA/extdata/sp_data/WYbighorn_dem_250m.img</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> reprojecting layer... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  from: NAD83 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  to: PROJCS["North_American_1927_Albers",GEOGCS["NAD27",DATUM["North_American_Datum_1927",SPHEROID["Clarke 1866",6378206.4,294.9786982,AUTHORITY["EPSG","7008"]],AUTHORITY["EPSG","6267"]],PRIMEM["Greenwich",0],UNIT["Degree",0.0174532925199433]],PROJECTION["Albers_Conic_Equal_Area"],PARAMETER["latitude_of_center",23],PARAMETER["longitude_of_center",-96],PARAMETER["standard_parallel_1",29.5],PARAMETER["standard_parallel_2",45.5],PARAMETER["false_easting",0],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ================================================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $zonalext</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       DISTRICTNA WYbighorn_dem_250m.mean WYbighorn_dem_250m.sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Medicine Wheel Ranger District                2650.793               62603774</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Powder River Ranger District                2686.069               58150700</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         Tongue Ranger District                2538.865               67965407</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $outname</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "WYbighorn_dem_250m.mean" "WYbighorn_dem_250m.sum" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rasterfile</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/private/var/folders/kd/4wp69y7d2yd3fxpd1_m64clm0000gn/T/RtmpWUzLtI/temp_libpath10a93f405e55/FIESTA/extdata/sp_data/WYbighorn_dem_250m.img"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "/private/var/folders/kd/4wp69y7d2yd3fxpd1_m64clm0000gn/T/RtmpWUzLtI/temp_libpath10a93f405e55/FIESTA/extdata/sp_data/WYbighorn_dem_250m.img"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Tracey Frescino, Gretchen Moisen, Paul Patterson, Chris Toney, Grayson White, Joshua Yamamoto.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

