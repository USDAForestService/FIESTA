<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Spatial - Clip (intersect) point vector layer with polygon vector layer. — spClipPoint • FIESTA</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Spatial - Clip (intersect) point vector layer with polygon vector layer. — spClipPoint"><meta property="og:description" content="Wrapper for sf::st_intersection, to clip (intersect) point vector layer with
a polygon vector layer."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FIESTA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.6.4.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/FIESTA_manual_mod_est.html">`FIESTA` Manual - Module Estimates</a>
    </li>
    <li>
      <a href="../articles/FIESTA_manual_mod_pop.html">`FIESTA` Manual - Population Data</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_dat.html">FIESTA - Data Tools</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_DB.html">FIESTA - Database Tools</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_GB.html">FIESTA - Green-book Estimators</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_MA.html">FIESTA - Model-Assisted Estimators</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_PB.html">FIESTA - Photo-Based Module</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_SA.html">FIESTA - Small Area Estimators</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_sp.html">FIESTA - Spatial Tools</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/USDAForestService/FIESTA/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Spatial - Clip (intersect) point vector layer with polygon vector layer.</h1>
    <small class="dont-index">Source: <a href="https://github.com/USDAForestService/FIESTA/blob/HEAD/R/spClipPoint.R" class="external-link"><code>R/spClipPoint.R</code></a></small>
    <div class="hidden name"><code>spClipPoint.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Wrapper for sf::st_intersection, to clip (intersect) point vector layer with
a polygon vector layer.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spClipPoint</span><span class="op">(</span></span>
<span>  <span class="va">xyplt</span>,</span>
<span>  xyplt_dsn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  uniqueid <span class="op">=</span> <span class="st">"PLT_CN"</span>,</span>
<span>  <span class="va">clippolyv</span>,</span>
<span>  clippolyv_dsn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  clippolyv.filter <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  buffdist <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  validate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  showext <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  keepNA <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  returnsp <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  othertabnms <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stopifnotin <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  savedata <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  exportsp <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  spMakeSpatial_opts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  savedata_opts <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>xyplt</dt>
<dd><p>sf R object or String. Point data to clip. Can be a spatial
points object, full pathname to a shapefile, or name of a layer within a
database.</p></dd>


<dt>xyplt_dsn</dt>
<dd><p>String. Data source name (dsn; e.g., sqlite or shapefile
pathname) of layer to clip. The dsn varies by driver. See gdal OGR vector
formats (https://www.gdal.org/ogr_formats.html).</p></dd>


<dt>uniqueid</dt>
<dd><p>String.* Unique identifier of xyplt rows.</p></dd>


<dt>clippolyv</dt>
<dd><p>sf R object or String. Name of clipping polygon spatial
polygon object, full path to shapefile, or name of a layer within a
database.</p></dd>


<dt>clippolyv_dsn</dt>
<dd><p>String. Data source name (dsn; e.g., sqlite or
shapefile pathname) of clipping polygon. The dsn varies by driver. See gdal
OGR vector formats (https://www.gdal.org/ogr_formats.html).</p></dd>


<dt>clippolyv.filter</dt>
<dd><p>String. Filter to subset clippolyv spatial layer.</p></dd>


<dt>buffdist</dt>
<dd><p>Number. The distance to buffer the polygon before clipping.
Uses sf::st_buffer. The distance is based on units of polygon, st_crs(x)$units.</p></dd>


<dt>validate</dt>
<dd><p>Logical. If TRUE, validates polyv and clippolyv before 
clipping. Uses sf::st_make_valid with default parameters 
(geos_method='valid_structure', geos_keep_collapsed=FALSE).</p></dd>


<dt>showext</dt>
<dd><p>Logical. If TRUE, layer extents are displayed in plot window.</p></dd>


<dt>keepNA</dt>
<dd><p>Logical. If TRUE, keep NA values after data intersection.</p></dd>


<dt>returnsp</dt>
<dd><p>Logical. If TRUE, returns sf object of points. If FALSE,
returns data frame of points (i.e., drops sf geometry).</p></dd>


<dt>othertabnms</dt>
<dd><p>String vector. Name(s) of R objects, comma-delimited
files, or database layers to subset. Must include quotes (e.g.,
othertabnms=c("tree", "cond")).</p></dd>


<dt>stopifnotin</dt>
<dd><p>Logical. If TRUE, stops if boundaries do not overlap.  If
FALSE, returns NULL.</p></dd>


<dt>savedata</dt>
<dd><p>Logical. If TRUE, save data to outfolder.</p></dd>


<dt>exportsp</dt>
<dd><p>Logical. If TRUE, the clipped spatial point data are
exported.</p></dd>


<dt>spMakeSpatial_opts</dt>
<dd><p>List. See help(spMakeSpatial_options()) for a list
of options. Use to convert X/Y values to simple feature (sf) coordinates.</p></dd>


<dt>savedata_opts</dt>
<dd><p>List. See help(savedata_options()) for a list
of options for saving data. If out_layer = NULL, default = 'pntclip'.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list of the following objects:</p>
<dl><dt>clip_xyplt</dt>
<dd><p>sf object. The input xyplt, clipped to polygon boundary
layer.  The projection will be same as clippolyv projection.</p></dd>

<dt>xy.uniqueid</dt>
<dd><p>String. Unique identifier of clip_xy.</p></dd>

<dt>clip_polyv</dt>
<dd><p>SpatialPolygonsDataFrame. The polygon boundary layer used
for clipping.</p></dd>
 <dt>clip_tabs</dt>
<dd><p>Data frame(s). Other tables in intabs
clipped to boundary.</p></dd>


</dl><p>If exportsp=TRUE, the sf object will be written to out_dsn (See note).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The sf::st_intersection function is used to clip points. <br></p>
<p>If the projection of clippolyv is not the same as the xyplt, the xyplt layer
layer will be reprojected to the same projection as the clippoly before
intersection.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>On-the-fly projection conversion<br> The spTransform (sf) method is
used for on-the-fly map projection conversion and datum transformation using
PROJ.4 arguments. Datum transformation only occurs if the +datum tag is
present in the both the from and to PROJ.4 strings. The +towgs84 tag is used
when no datum transformation is needed. PROJ.4 transformations assume NAD83
and WGS84 are identical unless other transformation parameters are
specified.  Be aware, providing inaccurate or incomplete CRS information may
lead to erroneous data shifts when reprojecting. See spTransform help
documentation for more details.</p>
<p>ESRI Shapefile Driver<br> If exportsp=TRUE:<br> The st_write (sf) function
is called. If out_fmt="shp", the ESRI Shapefile driver truncates variable
names to 10 characters or less. Variable names are changed before export
using an internal function (trunc10shp). If sf object has more than 1
record, it will be returned but not exported.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Tracey S. Frescino</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Get point data from WYplt data in FIESTA</span></span></span>
<span class="r-in"><span><span class="va">WYplt</span> <span class="op">&lt;-</span> <span class="fu">FIESTA</span><span class="fu">::</span><span class="va"><a href="WYplt.html">WYplt</a></span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get polygon vector layer from FIESTA external data</span></span></span>
<span class="r-in"><span><span class="va">WYbhdistfn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span></span>
<span class="r-in"><span>                          <span class="st">"sp_data/WYbighorn_districtbnd.shp"</span>,</span></span>
<span class="r-in"><span>                          package <span class="op">=</span> <span class="st">"FIESTA"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract points from polygon vector layer</span></span></span>
<span class="r-in"><span><span class="va">xyext</span> <span class="op">&lt;-</span> <span class="fu">spClipPoint</span><span class="op">(</span>xyplt <span class="op">=</span> <span class="va">WYplt</span>,</span></span>
<span class="r-in"><span>                     clippolyv <span class="op">=</span> <span class="va">WYbhdistfn</span>,</span></span>
<span class="r-in"><span>                     clippolyv.filter <span class="op">=</span> <span class="st">"DISTRICTNU == '03'"</span>,</span></span>
<span class="r-in"><span>                     uniqueid <span class="op">=</span> <span class="st">"CN"</span>,</span></span>
<span class="r-in"><span>                     spMakeSpatial_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>xvar <span class="op">=</span> <span class="st">"LON_PUBLIC"</span>,</span></span>
<span class="r-in"><span>                                               yvar <span class="op">=</span> <span class="st">"LAT_PUBLIC"</span>,</span></span>
<span class="r-in"><span>                                               xy.crs <span class="op">=</span> <span class="fl">4269</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> DISTRICTNU == '03'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> filter removed 2 records: DISTRICTNU == '03'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> crs.default must be in a projected CRS... using US albers</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> +proj=aea +lat_0=23 +lon_0=-96 +lat_1=29.5 +lat_2=45.5 +x_0=0 +y_0=0 +datum=NAD83 +units=m +no_defs +type=crs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> reprojecting layer... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  from: EPSG:4269 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  to: +proj=aea +lat_0=23 +lon_0=-96 +lat_1=29.5 +lat_2=45.5 +x_0=0 +y_0=0 +datum=NAD83 +units=m +no_defs +type=crs</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">xyext</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "clip_xyplt" "uniqueid"   "clip_polyv"</span>
<span class="r-in"><span><span class="va">xyplt</span> <span class="op">&lt;-</span> <span class="va">xyext</span><span class="op">$</span><span class="va">clip_xyplt</span></span></span>
<span class="r-in"><span><span class="va">polyv</span> <span class="op">&lt;-</span> <span class="va">xyext</span><span class="op">$</span><span class="va">clip_polyv</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot extracted values of national forest district</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">polyv</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">xyplt</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="spClipPoint-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Tracey Frescino, Gretchen Moisen, Paul Patterson, Chris Toney, Grayson White, Joshua Yamamoto.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

